<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>giant.stellar_opnav.stellar_class &#8212; GIANT 2.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css?v=3f530b75" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=aae3c237" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />
    <script src="../../../_static/documentation_options.js?v=51b770b3"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="../../../_static/logo.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="copyright" title="Copyright" href="../../../copyright.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../../index.html">
    <img class="logo" src="../../../_static/logo.png" alt="Logo" />
    
  </a>
</p>



<p class="blurb">A powerful API for Optical Navigation</p>






<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installing GIANT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../giant.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../giant.html#indices">Indices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../copyright.html">Copyright</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <h1>Source code for giant.stellar_opnav.stellar_class</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module provides a subclass of the :class:`.OpNav` class for performing stellar OpNav.</span>

<span class="sd">Interface Description</span>
<span class="sd">---------------------</span>

<span class="sd">In GIANT, Stellar OpNav refers to the process of identifying stars in an image and then extracting the attitude</span>
<span class="sd">information from those stars.  This module combines these two processes into the single process of Stellar OpNav.</span>

<span class="sd">The :class:`StellarOpNav` class is the main interface for performing stellar OpNav in GIANT, and in general is all</span>
<span class="sd">the user will need to interact with in order to process the images.  It provides direct access to the</span>
<span class="sd">:class:`.PointOfInterestFinder`, :class:`.StarID`, and :mod:`.stellar_opnav.estimators` objects and automatically performs the</span>
<span class="sd">required data transfer between the objects for you.  To begin you simply provide the :class:`StellarOpNav` constructor</span>
<span class="sd">a :class:`.Camera` instance and an instance of :class:`.StellarOpNavOptions` with which to configure the class. </span>
<span class="sd">You can then use the :class:`StellarOpNav` instance to perform all of the aspects of</span>
<span class="sd">stellar OpNav with never having to interact with the internal objects again.</span>

<span class="sd">For example, we could do something like the following (from the directory containing ``sample_data`` as generated by a</span>
<span class="sd">call to :mod:`.generate_sample_data`):</span>

<span class="sd">    &gt;&gt;&gt; import pickle</span>
<span class="sd">    &gt;&gt;&gt; from giant.stellar_opnav import StellarOpNav</span>
<span class="sd">    &gt;&gt;&gt; with open(&#39;sample_data/camera.pickle&#39;, &#39;rb&#39;) as in_file:</span>
<span class="sd">    ...     camera = pickle.load(in_file)</span>
<span class="sd">    &gt;&gt;&gt; camera.only_long_on()</span>
<span class="sd">    &gt;&gt;&gt; my_sid = StellarOpNav(camera)</span>
<span class="sd">    &gt;&gt;&gt; my_sid.id_stars()  # id the stars for each image</span>
<span class="sd">    &gt;&gt;&gt; my_sid.sid_summary()  # print out a summary of the star identification success for each image</span>
<span class="sd">    &gt;&gt;&gt; my_sid.estimate_attitude()  # estimate an updated attitude for each image</span>

<span class="sd">In order to identify stars and estimate the image attitude based off of those stars for all of our images.</span>

<span class="sd">For a more general description of the steps needed to perform stellar OpNav, refer to the :mod:`.stellar_opnav`</span>
<span class="sd">documentation.  For a more in-depth examination of the :class:`.StellarOpNav` class continue through the following class</span>
<span class="sd">documentation.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Sequence</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">NDArray</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">giant.stellar_opnav.star_identification</span><span class="w"> </span><span class="kn">import</span> <span class="n">StarID</span><span class="p">,</span> <span class="n">StarIDOptions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">giant.utilities.outlier_identifier</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_outliers</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">giant.opnav_class</span><span class="w"> </span><span class="kn">import</span> <span class="n">OpNav</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">giant.camera</span><span class="w"> </span><span class="kn">import</span> <span class="n">Camera</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">giant.stellar_opnav.estimators</span><span class="w"> </span><span class="kn">import</span> <span class="n">AttitudeEstimatorOptions</span><span class="p">,</span> <span class="n">AttitudeEstimator</span><span class="p">,</span> <span class="n">AttitudeEstimatorImplementations</span><span class="p">,</span> <span class="n">ESOQ2Options</span><span class="p">,</span> <span class="n">get_estimator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">giant.image_processing.point_source_finder</span><span class="w"> </span><span class="kn">import</span> <span class="n">PointOfInterestFinder</span><span class="p">,</span> <span class="n">PointOfInterestFinderOptions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">giant.image_processing.denoising</span><span class="w"> </span><span class="kn">import</span> <span class="n">DENOISING_TYPE</span><span class="p">,</span> <span class="n">GaussianDenoising</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">giant.ray_tracer.scene</span><span class="w"> </span><span class="kn">import</span> <span class="n">Scene</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">giant.ray_tracer.rays</span><span class="w"> </span><span class="kn">import</span> <span class="n">Rays</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">giant.point_spread_functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">PointSpreadFunction</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">giant._typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">DOUBLE_ARRAY</span><span class="p">,</span> <span class="n">PATH</span><span class="p">,</span> <span class="n">NONEARRAY</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">giant.utilities.options</span><span class="w"> </span><span class="kn">import</span> <span class="n">UserOptions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">giant.utilities.mixin_classes</span><span class="w"> </span><span class="kn">import</span> <span class="n">UserOptionConfigured</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">giant.utilities.boolean_filter_list</span><span class="w"> </span><span class="kn">import</span> <span class="n">boolean_filter_list</span>


<div class="viewcode-block" id="StellarOpNavOptions">
<a class="viewcode-back" href="../../../stellar_opnav/stellar_class/giant.stellar_opnav.stellar_class.StellarOpNavOptions.html#giant.stellar_opnav.stellar_class.StellarOpNavOptions">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">StellarOpNavOptions</span><span class="p">(</span><span class="n">UserOptions</span><span class="p">):</span>
    
    <span class="n">use_weights</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A flag specifying whether to use weighted estimation for attitude estimation </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">scene</span><span class="p">:</span> <span class="n">Scene</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Optionally, a scene defining the targets that may be in the FOV of the camera used to reject points interior to </span>
<span class="sd">    a body as stars.  </span>
<span class="sd">                    </span>
<span class="sd">    If ``None`` then no attempt is made to reject points that might be interior to a body. If not ``None`` then we </span>
<span class="sd">    will attempt to reject these points using a priori knowledge.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">point_of_interest_finder_options</span><span class="p">:</span> <span class="n">PointOfInterestFinderOptions</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span> <span class="o">=</span> <span class="n">PointOfInterestFinderOptions</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Options to use to initialize the point of interest finder instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">star_id_options</span><span class="p">:</span> <span class="n">StarIDOptions</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">StarIDOptions</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Options to use to initialize the star_id instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">attitude_estimator_options</span><span class="p">:</span> <span class="n">AttitudeEstimatorOptions</span> <span class="o">|</span> <span class="n">ESOQ2Options</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Options to use to initialize the attitude estimator instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">custom_attitude_estimator_class</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">AttitudeEstimator</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A custom attitude estimator class to use instead of one of the standard provided ones</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">attitude_estimator_type</span><span class="p">:</span> <span class="n">AttitudeEstimatorImplementations</span>  <span class="o">=</span> <span class="n">AttitudeEstimatorImplementations</span><span class="o">.</span><span class="n">DAVENPORT_Q_METHOD</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Which attitude estimator to use.</span>
<span class="sd">    </span>
<span class="sd">    For a custom implementation choose CUSTOM</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">denoising</span><span class="p">:</span> <span class="n">DENOISING_TYPE</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">GaussianDenoising</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    What denoising to apply to the image before looking for stars.</span>
<span class="sd">    </span>
<span class="sd">    Generally the default (GaussianDenoising) should be fine and you can probably have success with NlMeansDenoising as well.</span>
<span class="sd">    </span>
<span class="sd">    If None then no denoising is applied.</span>
<span class="sd">    &quot;&quot;&quot;</span></div>

    
    
<div class="viewcode-block" id="StellarOpNav">
<a class="viewcode-back" href="../../../stellar_opnav/stellar_class/giant.stellar_opnav.stellar_class.StellarOpNav.html#giant.stellar_opnav.stellar_class.StellarOpNav">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">StellarOpNav</span><span class="p">(</span><span class="n">UserOptionConfigured</span><span class="p">[</span><span class="n">StellarOpNavOptions</span><span class="p">],</span> <span class="n">OpNav</span><span class="p">,</span> <span class="n">StellarOpNavOptions</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class serves as the main user interface for performing Stellar Optical Navigation.</span>

<span class="sd">    The class acts as a container for the :class:`.Camera`, :class:`.PointOfInterestFinder`, :class:`.StarId`, and</span>
<span class="sd">    :mod:`.stellar_opnav.estimators` objects and also passes the correct and up-to-date data from one</span>
<span class="sd">    object to the other. In general, this class will be the exclusive interface to the mentioned objects and models</span>
<span class="sd">    for the user.</span>

<span class="sd">    This class provides a number of features that make doing stellar OpNav easy.  The first is it provides aliases to</span>
<span class="sd">    the point of interest finder, star id, and attitude estimation instances.  These</span>
<span class="sd">    aliases make it easy to quickly change/update the various tuning parameters that are necessary to make star</span>
<span class="sd">    identification a success.  In addition to providing convenient access to the underlying settings, some of these</span>
<span class="sd">    aliases also update internal flags that specify whether individual images need to be reprocessed, saving computation</span>
<span class="sd">    time when you&#39;re trying to find the best tuning.</span>

<span class="sd">    This class also provides simple methods for performing star identification and attitude estimation after</span>
<span class="sd">    you have set the tuning parameters.  These methods (:meth:`id_stars`, :meth:`sid_summary`, and</span>
<span class="sd">    :meth:`estimate_attitude`) combine all of the required steps into a few simple calls, and pass the resulting data</span>
<span class="sd">    from one object to the next.  They also store off the results of the star identification in the</span>
<span class="sd">    :attr:`queried_catalog_star_records`, :attr:`queried_catalog_image_points`,</span>
<span class="sd">    :attr:`queried_catalog_unit_vectors`, :attr:`extracted_image_points`, :attr:`extracted_image_illums`,</span>
<span class="sd">    :attr:`extracted_psfs`, :attr:`extracted_stats`, :attr:`extracted_snrs`</span>
<span class="sd">    :attr:`unmatched_catalog_image_points`, :attr:`unmatched_image_illums`,</span>
<span class="sd">    :attr:`unmatched_psfs`, :attr:`unmatched_stats`, :attr:`unmatched_snrs`</span>
<span class="sd">    :attr:`unmatched_catalog_star_records`,</span>
<span class="sd">    :attr:`unmatched_catalog_unit_vectors`,</span>
<span class="sd">    :attr:`unmatched_extracted_image_points`,</span>
<span class="sd">    :attr:`matched_catalog_image_points`, :attr:`matched_image_illums`,</span>
<span class="sd">    :attr:`matched_psfs`, :attr:`matched_stats`, :attr:`matched_snrs`</span>
<span class="sd">    :attr:`matched_catalog_star_records`,</span>
<span class="sd">    :attr:`matched_catalog_unit_vectors_inertial`,</span>
<span class="sd">    :attr:`matched_catalog_unit_vectors_camera`, and</span>
<span class="sd">    :attr:`matched_extracted_image_points` attributes, enabling more advanced analysis to be performed external to the</span>
<span class="sd">    class.</span>

<span class="sd">    Finally, this class stores the updated attitude solutions in the image objects themselves, allowing you to directly</span>
<span class="sd">    pass your images from stellar OpNav to the :mod:`.relative_opnav` routines with updated attitude solutions.  It also</span>
<span class="sd">    respects the :attr:`.image_mask` attribute of the :class:`.Camera` object, only considering images that are</span>
<span class="sd">    currently turned on.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">camera</span><span class="p">:</span> <span class="n">Camera</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="n">StellarOpNavOptions</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param camera: The :class:`.Camera` object containing the camera model and images to be utilized</span>
<span class="sd">        :param options: The options to use to configure the class.  If `None`, the defaults from :class:`.StellarOpNavOptions` are used</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># initialize the various objects we need for the star identification and attitude estimation</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">StellarOpNavOptions</span><span class="p">,</span> <span class="n">camera</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span> <span class="o">=</span> <span class="n">StarID</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">star_id_options</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_weights</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">compute_weights</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;If use_weights is set to True, compute_weights must be set to True in the star id options&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attitude_estimator_type</span> <span class="ow">is</span> <span class="n">AttitudeEstimatorImplementations</span><span class="o">.</span><span class="n">CUSTOM</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_attitude_estimator_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Custom implementation must be provided by the user&quot;</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_attitude_est</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_attitude_estimator_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attitude_estimator_options</span><span class="p">)</span> <span class="c1"># type: ignore</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_attitude_est</span> <span class="o">=</span> <span class="n">get_estimator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attitude_estimator_type</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attitude_estimator_options</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_poi_finder</span> <span class="o">=</span> <span class="n">PointOfInterestFinder</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">point_of_interest_finder_options</span><span class="p">)</span>

        <span class="c1"># initialize the various lists for storing the results and specifying whether stars need to be extracted from</span>
        <span class="c1"># the images or not</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_stars</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains a boolean specifying whether the corresponding image needs to be processed using image </span>
<span class="sd">        processing again.  </span>
<span class="sd">        </span>
<span class="sd">        This typically is automatically updated and you shouldn&#39;t have to worry about it.  It is included for speed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_image_points</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_image_illums</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">NDArray</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_psfs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">PointSpreadFunction</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_stats</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_snrs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_star_records</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_image_points</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_unit_vectors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queried_weights_inertial</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queried_weights_picture</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_image_points</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_image_points</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_star_records</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_unit_vectors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_weights_inertial</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_weights_picture</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_image_points</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_image_illums</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">NDArray</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_psfs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">PointSpreadFunction</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_stats</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_snrs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_image_points</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_star_records</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_inertial</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_camera</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_inertial</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_picture</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_image_points</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_image_illums</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">NDArray</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_psfs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">PointSpreadFunction</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_stats</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_snrs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>

    <span class="c1"># ____________________________________________Camera Properties____________________________________________</span>

<div class="viewcode-block" id="StellarOpNav.add_images">
<a class="viewcode-back" href="../../../stellar_opnav/stellar_class/giant.stellar_opnav.stellar_class.StellarOpNav.add_images.html#giant.stellar_opnav.stellar_class.StellarOpNav.add_images">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_images</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">PATH</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">]],</span> <span class="n">PATH</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">],</span>
                   <span class="n">parse_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is essentially an alias to the :meth:`.Camera.add_images` method, but it also expands various lists to</span>
<span class="sd">        account for the new number of images.</span>

<span class="sd">        When you have already initialized a :class:`StellarOpNav` class you should *always* use this method to add</span>
<span class="sd">        images for consideration.</span>

<span class="sd">        The lists that are extended by this method are:</span>

<span class="sd">        * :attr:`extracted_image_points`</span>
<span class="sd">        * :attr:`extracted_image_illums`</span>
<span class="sd">        * :attr:`extracted_psfs`</span>
<span class="sd">        * :attr:`extracted_stats`</span>
<span class="sd">        * :attr:`extracted_snrs`</span>
<span class="sd">        * :attr:`queried_catalog_star_records`</span>
<span class="sd">        * :attr:`queried_catalog_image_points`</span>
<span class="sd">        * :attr:`queried_catalog_unit_vectors`</span>
<span class="sd">        * :attr:`queried_weights_inertial`</span>
<span class="sd">        * :attr:`queried_weights_picture`</span>
<span class="sd">        * :attr:`unmatched_catalog_star_records`</span>
<span class="sd">        * :attr:`unmatched_catalog_image_points`</span>
<span class="sd">        * :attr:`unmatched_catalog_unit_vectors`</span>
<span class="sd">        * :attr:`unmatched_extracted_image_points`</span>
<span class="sd">        * :attr:`unmatched_psfs`</span>
<span class="sd">        * :attr:`unmatched_stats`</span>
<span class="sd">        * :attr:`unmatched_snrs`</span>
<span class="sd">        * :attr:`unmatched_image_illums`</span>
<span class="sd">        * :attr:`unmatched_weights_inertial`</span>
<span class="sd">        * :attr:`unmatched_weights_picture`</span>
<span class="sd">        * :attr:`matched_catalog_star_records`</span>
<span class="sd">        * :attr:`matched_catalog_image_points`</span>
<span class="sd">        * :attr:`matched_catalog_unit_vectors_inertial`</span>
<span class="sd">        * :attr:`matched_extracted_image_points`</span>
<span class="sd">        * :attr:`matched_weights_inertial`</span>
<span class="sd">        * :attr:`matched_weights_picture`</span>
<span class="sd">        * :attr:`matched_psfs`</span>
<span class="sd">        * :attr:`matched_stats`</span>
<span class="sd">        * :attr:`matched_snrs`</span>
<span class="sd">        * :attr:`matched_image_illums`</span>
<span class="sd">        * :attr:`matched_catalog_unit_vectors_camera`</span>
<span class="sd">        * :attr:`process_stars`</span>

<span class="sd">        See the :meth:`.Camera.add_images` for a description of the valid input for `data`</span>

<span class="sd">        :param data:  The image data to be stored in the :attr:`.images` list</span>
<span class="sd">        :param parse_data:  A flag to specify whether to attempt to parse the metadata automatically for the images</span>
<span class="sd">        :param preprocessor: A flag to specify whether to run the preprocessor after loading an image.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_images</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">parse_data</span><span class="o">=</span><span class="n">parse_data</span><span class="p">,</span> <span class="n">preprocessor</span><span class="o">=</span><span class="n">preprocessor</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_image_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_image_illums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_psfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_stats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_snrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">process_stars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_star_records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_image_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_unit_vectors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_queried_weights_inertial</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_queried_weights_picture</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_star_records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_image_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_unit_vectors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_image_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_psfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_image_illums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_weights_inertial</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_weights_picture</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_stats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_snrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_star_records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_image_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_inertial</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_image_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_inertial</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_picture</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_psfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_image_illums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_camera</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_stats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_snrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_image_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_image_illums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_psfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_stats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_snrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">process_stars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_star_records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_image_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_unit_vectors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queried_weights_inertial</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queried_weights_picture</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_star_records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_image_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_unit_vectors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_image_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_psfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_image_illums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_weights_inertial</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_weights_picture</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_stats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_snrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_star_records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_image_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_inertial</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_image_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_inertial</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_picture</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_psfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_stats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_snrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_image_illums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_camera</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span></div>


    <span class="nd">@OpNav</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="c1"># don&#39;t know why we can&#39;t dispatch here...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">val</span>

    <span class="c1"># ____________________________________________ Aliases ____________________________________________</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">star_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The StarID instance to use when doing star identification</span>

<span class="sd">        This should be an instance of the :class:`.StarID` class.</span>

<span class="sd">        See the :class:`.StarID` class documentation for more details</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span>

    <span class="nd">@star_id</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">star_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="n">StarID</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">StarID</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;The star_id object should probably subclass the StarID class</span><span class="se">\n</span><span class="s2">&quot;</span>
                          <span class="s2">&quot;We&#39;ll assume you know what you&#39;re doing for now, but &quot;</span>
                          <span class="s2">&quot;see the StarID documentation for details&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span> <span class="o">=</span> <span class="n">val</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">attitude_estimator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AttitudeEstimator</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The attitude estimator to use in the RANSAC algorithm</span>

<span class="sd">        This should typically be an instance of the :class:`.AttitudeEstimator` class.</span>

<span class="sd">        See the :class:`.AttitudeEstimator` class documentation for more details</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attitude_est</span>

    <span class="nd">@attitude_estimator</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">attitude_estimator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="n">AttitudeEstimator</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">AttitudeEstimator</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;The attitude_estimator object should probably subclass the AttitudeEstimator class</span><span class="se">\n</span><span class="s2">&quot;</span>
                          <span class="s2">&quot;We&#39;ll assume you know what you&#39;re doing for now, but &quot;</span>
                          <span class="s2">&quot;see the AttitudeEstimator documentation for details&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_attitude_est</span> <span class="o">=</span> <span class="n">val</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">point_of_interest_finder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PointOfInterestFinder</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The :class:`.PointOfInterestFinder` instance to use when doing image processing on the images</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># we need to call this here in case the user does `sopnav.point_of_interest_finder.threshold = 5`</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reset_process_stars</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_poi_finder</span>
    
    <span class="nd">@point_of_interest_finder</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">point_of_interest_finder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="n">PointOfInterestFinder</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reset_process_stars</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_poi_finder</span> <span class="o">=</span> <span class="n">val</span>

    <span class="c1"># ___________________________________________________ PROPERTIES ______________________________________________</span>
    <span class="c1"># queried information</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">queried_catalog_star_records</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains all of the star records queried from the star catalog for each image in :attr:`camera` for</span>
<span class="sd">        the most recent query to star catalog (this gets overwritten when the star catalog is re-queried for the</span>
<span class="sd">        image)</span>

<span class="sd">        Each list element is a pandas DataFrame containing GIANT star records.  A GIANT star record has the following</span>
<span class="sd">        columns:</span>

<span class="sd">        ===================== ======== =================================================================================</span>
<span class="sd">        column                units    description</span>
<span class="sd">        ===================== ======== =================================================================================</span>
<span class="sd">        `&#39;ra&#39;`                deg      The right ascension of the star after correcting for proper motion</span>
<span class="sd">        `&#39;dec&#39;`               deg      The declination of the star after correcting for proper motion</span>
<span class="sd">        `&#39;distance&#39;`          km       The distance to the star from the Solar system barycenter (converted from</span>
<span class="sd">                                       parallax). This column has a default value of 5.428047027e15 if no parallax</span>
<span class="sd">                                       information is provided by the catalog.</span>
<span class="sd">        `&#39;ra_proper_motion&#39;`  deg/year The proper motion for the right ascension</span>
<span class="sd">        `&#39;dec_proper_motion&#39;` deg/year The proper motion for the declination</span>
<span class="sd">        `&#39;mag&#39;`               N/A      The apparent magnitude of the star according to the star catalog</span>
<span class="sd">        `&#39;ra_sigma&#39;`          deg      The formal uncertainty in the right ascension according to the catalog</span>
<span class="sd">        `&#39;dec_sigma&#39;`         deg      The formal uncertainty in the declination according to the catalog</span>
<span class="sd">        `&#39;distance_sigma&#39;`    km       The formal uncertainty in the distance according to the catalog</span>
<span class="sd">                                       (converted from parallax).  This has a default value of</span>
<span class="sd">                                       1.9949433041226756e+19 km for stars with no parallax information.</span>
<span class="sd">        `&#39;ra_pm_sigma&#39;`       deg/year The formal uncertainty in the right ascension proper motion according to</span>
<span class="sd">                                       the catalog</span>
<span class="sd">        `&#39;dec_pm_sigma&#39;`      deg/year The formal uncertainty in the declination proper motion according to the</span>
<span class="sd">                                       catalog</span>
<span class="sd">        ===================== ======== =================================================================================</span>

<span class="sd">        Each row of the data frame represents a star record. Each row of the DataFrame matches to the corresponding</span>
<span class="sd">        column in the :attr:`queried_catalog_unit_vectors` and  :attr:`queried_catalog_image_points` arrays.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_star_records</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">queried_catalog_image_points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the projections of all of the star records queried from the star catalog for each image in</span>
<span class="sd">        :attr:`camera` from the most recent query to star catalog (this gets overwritten when the star catalog is</span>
<span class="sd">        re-queried for the image, and also when the attitude is updated for an image).</span>

<span class="sd">        Each list element is a 2xn array of image points with the x locations (columns) down the first row and the y</span>
<span class="sd">        locations (rows) down the second row. Each column of the array matches to the corresponding</span>
<span class="sd">        column in the :attr:`queried_catalog_unit_vectors` array and the corresponding row in the</span>
<span class="sd">        :attr:`queried_catalog_star_records` DataFrame.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_image_points</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">queried_catalog_unit_vectors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the inertial unit vectors of all of the star records queried from the star catalog for each</span>
<span class="sd">        image in :attr:`camera` from the most recent query to star catalog (this gets overwritten when the star</span>
<span class="sd">        catalog is re-queried for the image).  The unit vectors are the directions to the stars after correcting for</span>
<span class="sd">        proper motion, stellar aberration, and parallax.</span>

<span class="sd">        Each list element is a 3xn array of unit vectors with each unit vector stored as a column.</span>
<span class="sd">        Each column of the array matches to the corresponding column in the :attr:`queried_catalog_image_points`</span>
<span class="sd">        array and the corresponding row in the :attr:`queried_catalog_star_records` DataFrame.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_unit_vectors</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">queried_weights_inertial</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the uncertainty of all of the star records queried from the star catalog for each</span>
<span class="sd">        image in :attr:`camera` from the most recent query to star catalog (this gets overwritten when the star</span>
<span class="sd">        catalog is re-queried for the image).  The uncertainties are based on the formal uncertainty of the star</span>
<span class="sd">        location according to the star catalog and are for the unit vector representation.</span>

<span class="sd">        A single value is provided for each unit vector representing the sum of the squares of the uncertainty (the</span>
<span class="sd">        trace of the covariance matrix). Each element of the array matches to the corresponding column in the</span>
<span class="sd">        :attr:`queried_catalog_image_points` array and the corresponding row in the</span>
<span class="sd">        :attr:`queried_catalog_star_records` DataFrame.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queried_weights_inertial</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">queried_weights_picture</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the uncertainty of all of the star records queried from the star catalog for each</span>
<span class="sd">        image in :attr:`camera` from the most recent query to star catalog (this gets overwritten when the star</span>
<span class="sd">        catalog is re-queried for the image).  The uncertainties are based on the formal uncertainty of the star</span>
<span class="sd">        location according to the star catalog and are for the pixel representation of the star location.</span>

<span class="sd">        A single value is provided for each unit vector representing the sum of the squares of the uncertainty (the</span>
<span class="sd">        trace of the covariance matrix). Each element of the array matches to the corresponding column in the</span>
<span class="sd">        :attr:`queried_catalog_image_points` array and the corresponding row in the</span>
<span class="sd">        :attr:`queried_catalog_star_records` DataFrame.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queried_weights_picture</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">extracted_image_points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains all of the image points of interest that were identified by the image processing routines for</span>
<span class="sd">        all of the images in :attr:`camera` from the most recent processing of the image (this gets overwritten when the</span>
<span class="sd">        image is reprocessed through the image processing routines).</span>

<span class="sd">        Each list element is a 2xn array of image points with the x locations (cols) down the first row and the y</span>
<span class="sd">        locations (rows) down the second row.  Each column of this array matches with the corresponding row in the</span>
<span class="sd">        :attr:`extracted_image_illums` array.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_image_points</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">extracted_image_illums</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">NDArray</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the DN values of the pixels containing the image points of interest</span>
<span class="sd">        for each image in :attr:`camera` that were identified by the image processing routines as potential stars</span>
<span class="sd">        (this gets overwritten when the image is reprocessed through the image processing routines).</span>

<span class="sd">        Each list element is a length n array of image DN values. Each row of the array matches to the corresponding</span>
<span class="sd">        column in the :attr:`extracted_image_points` array.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_image_illums</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">extracted_psfs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">PointSpreadFunction</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains point spread function object for each object identified as a potential star</span>
<span class="sd">        for each image in :attr:`camera` that were identified by the image processing routines as potential stars</span>
<span class="sd">        (this gets overwritten when the image is reprocessed through the image processing routines).</span>

<span class="sd">        Each list element is a length n list of PSF objects. Each element of the array matches to the corresponding</span>
<span class="sd">        column in the :attr:`extracted_image_points` array.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_psfs</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">extracted_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the connected component stats for each object identified as a potential star</span>
<span class="sd">        for each image in :attr:`camera` that were identified by the image processing routines as potential stars</span>
<span class="sd">        (this gets overwritten when the image is reprocessed through the image processing routines).</span>

<span class="sd">        Each list element is a length n list of stats. Each element of the list matches to the corresponding</span>
<span class="sd">        column in the :attr:`extracted_image_points` array.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_stats</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">extracted_snrs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the peak snr value for each object identified as a potential star</span>
<span class="sd">        for each image in :attr:`camera` that were identified by the image processing routines as potential stars</span>
<span class="sd">        (this gets overwritten when the image is reprocessed through the image processing routines).</span>

<span class="sd">        Each list element is a length n list of SNR values. Each element of the sublist matches to the corresponding</span>
<span class="sd">        column in the :attr:`extracted_image_points` array.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_snrs</span>

    <span class="c1"># unmatched information</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">unmatched_catalog_star_records</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the star records queried from the star catalog that were not matched with an image point of</span>
<span class="sd">        interest for each image in :attr:`camera` for the most recent star identification attempt (this gets</span>
<span class="sd">        overwritten when a new attempt is made at identifying the stars in the image)</span>

<span class="sd">        Each list element is a pandas DataFrame containing GIANT star records.  A GIANT star record has the following</span>
<span class="sd">        columns:</span>

<span class="sd">        ===================== ======== =================================================================================</span>
<span class="sd">        column                units    description</span>
<span class="sd">        ===================== ======== =================================================================================</span>
<span class="sd">        `&#39;ra&#39;`                deg      The right ascension of the star after correcting for proper motion</span>
<span class="sd">        `&#39;dec&#39;`               deg      The declination of the star after correcting for proper motion</span>
<span class="sd">        `&#39;distance&#39;`          km       The distance to the star from the Solar system barycenter (converted from</span>
<span class="sd">                                       parallax). This column has a default value of 5.428047027e15 if no parallax</span>
<span class="sd">                                       information is provided by the catalog.</span>
<span class="sd">        `&#39;ra_proper_motion&#39;`  deg/year The proper motion for the right ascension</span>
<span class="sd">        `&#39;dec_proper_motion&#39;` deg/year The proper motion for the declination</span>
<span class="sd">        `&#39;mag&#39;`               N/A      The apparent magnitude of the star according to the star catalog</span>
<span class="sd">        `&#39;ra_sigma&#39;`          deg      The formal uncertainty in the right ascension according to the catalog</span>
<span class="sd">        `&#39;dec_sigma&#39;`         deg      The formal uncertainty in the declination according to the catalog</span>
<span class="sd">        `&#39;distance_sigma&#39;`    km       The formal uncertainty in the distance according to the catalog</span>
<span class="sd">                                       (converted from parallax).  This has a default value of</span>
<span class="sd">                                       1.9949433041226756e+19 km for stars with no parallax information.</span>
<span class="sd">        `&#39;ra_pm_sigma&#39;`       deg/year The formal uncertainty in the right ascension proper motion according to</span>
<span class="sd">                                       the catalog</span>
<span class="sd">        `&#39;dec_pm_sigma&#39;`      deg/year The formal uncertainty in the declination proper motion according to the</span>
<span class="sd">                                       catalog</span>
<span class="sd">        ===================== ======== =================================================================================</span>

<span class="sd">        Each row of the data frame represents a star record. Each row of the DataFrame matches to the corresponding</span>
<span class="sd">        column in the :attr:`unmatched_catalog_unit_vectors` and  :attr:`unmatched_catalog_image_points` arrays.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_star_records</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">unmatched_catalog_image_points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the projections of the star records queried from the star catalog that were not matched</span>
<span class="sd">        with an image point of interest for each image in :attr:`camera` from the most recent star identification</span>
<span class="sd">        attempt (this gets overwritten when a new attempt is made at identifying the stars in the image, and also when</span>
<span class="sd">        a new attitude is solved for the image).</span>

<span class="sd">        Each list element is a 2xn array of image points with the x locations (columns) down the first row and the y</span>
<span class="sd">        locations (rows) down the second row. Each column of the array matches to the corresponding</span>
<span class="sd">        column in the :attr:`unmatched_catalog_unit_vectors` array and the corresponding row in the</span>
<span class="sd">        :attr:`unmatched_catalog_star_records` DataFrame.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_image_points</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">unmatched_catalog_unit_vectors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the inertial unit vectors of the star records queried from the star catalog that were not</span>
<span class="sd">        matched with an image point of interest for each image in :attr:`camera` from the most recent star</span>
<span class="sd">        identification attempt (this gets overwritten when a new attempt is made at identifying the stars in the</span>
<span class="sd">        image). The unit vectors are the directions to the stars after correcting for</span>
<span class="sd">        proper motion, stellar aberration, and parallax.</span>

<span class="sd">        Each list element is a 3xn array of unit vectors with each unit vector stored as a column.</span>
<span class="sd">        Each column of the array matches to the corresponding column in the :attr:`unmatched_catalog_image_points`</span>
<span class="sd">        array and the corresponding row in the :attr:`unmatched_catalog_star_records` DataFrame.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_unit_vectors</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">unmatched_weights_inertial</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the uncertainty of all of the star records queried from the star catalog that were not</span>
<span class="sd">        matched with an image point of interest for each image in :attr:`camera` from the most recent query to star</span>
<span class="sd">        catalog (this gets overwritten when the star catalog is re-queried for the image).  The uncertainties are</span>
<span class="sd">        based on the formal uncertainty of the star location according to the star catalog and are for the unit</span>
<span class="sd">        vector representation.</span>

<span class="sd">        A single value is provided for each unit vector representing the sum of the squares of the uncertainty (the</span>
<span class="sd">        trace of the covariance matrix). Each element of the array matches to the corresponding column in the</span>
<span class="sd">        :attr:`unmatched_catalog_image_points` array and the corresponding row in the</span>
<span class="sd">        :attr:`unmatched_catalog_star_records` DataFrame.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_weights_inertial</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">unmatched_weights_picture</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the uncertainty of all of the star records queried from the star catalog that were not</span>
<span class="sd">        matched with with an image point of interest for each image in :attr:`camera` from the most recent query to</span>
<span class="sd">        star catalog (this gets overwritten when the star catalog is re-queried for the image).  The</span>
<span class="sd">        uncertainties are based on the formal uncertainty of the star location according to the star catalog and</span>
<span class="sd">        are for the pixel representation of the star location.</span>

<span class="sd">        A single value is provided for each unit vector representing the sum of the squares of the uncertainty (the</span>
<span class="sd">        trace of the covariance matrix). Each element of the array matches to the corresponding column in the</span>
<span class="sd">        :attr:`unmatched_catalog_image_points` array and the corresponding row in the</span>
<span class="sd">        :attr:`unmatched_catalog_star_records` DataFrame.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_weights_picture</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">unmatched_extracted_image_points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the image points of interest that were not matched with a catalog star for each image in</span>
<span class="sd">        :attr:`camera` from the most recent star identification attempt (this gets overwritten when a new attempt is</span>
<span class="sd">        made at identifying the stars in the image).</span>

<span class="sd">        Each list element is a 2xn array of image points with the x locations (columns) down the first row and the y</span>
<span class="sd">        locations (rows) down the second row.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_image_points</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">unmatched_image_illums</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">NDArray</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the DN values of the pixel containing the image points of interest that are not matched with</span>
<span class="sd">        a catalog star for each image in :attr:`camera` from the most recent star identification attempt</span>
<span class="sd">        (this gets overwritten when a new attempt is made at identifying the stars in the image).</span>

<span class="sd">        Each list element is a length n array of image DN values. Each row of the array matches to the corresponding</span>
<span class="sd">        column in the :attr:`unmatched_extracted_image_points` array.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>

<span class="sd">        If no stars have been successfully identified for an image then the corresponding index of the list will be set</span>
<span class="sd">        to ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_image_illums</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">unmatched_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the connected component stats of each object that is not matched with a</span>
<span class="sd">        catalog star for each image in :attr:`camera` from the most recent star identification attempt</span>
<span class="sd">        (this gets overwritten when a new attempt is made at identifying the stars in the image).</span>

<span class="sd">        Each list element is a length n array of OpenCV connected components statistics. Each row of the array matches</span>
<span class="sd">        to the corresponding column in the :attr:`unmatched_extracted_image_points` array.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>

<span class="sd">        If no stars have been successfully identified for an image then the corresponding index of the list will be set</span>
<span class="sd">        to ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_stats</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">unmatched_snrs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the peak snr value of each object that is not matched with a</span>
<span class="sd">        catalog star for each image in :attr:`camera` from the most recent star identification attempt</span>
<span class="sd">        (this gets overwritten when a new attempt is made at identifying the stars in the image).</span>

<span class="sd">        Each list element is a length n array of OpenCV connected components statistics. Each row of the array matches</span>
<span class="sd">        to the corresponding column in the :attr:`unmatched_extracted_image_points` array.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>

<span class="sd">        If no stars have been successfully identified for an image then the corresponding index of the list will be set</span>
<span class="sd">        to ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_snrs</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">unmatched_psfs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">PointSpreadFunction</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the fit PSF object for each unmatched image point from the most recent star identification</span>
<span class="sd">        attempt (this gets overwritten when a new attempt is made at identifying the stars in the image).</span>

<span class="sd">        Each list element is a shape n array of PSF objects. Each element of the array matches to the corresponding</span>
<span class="sd">        column in the :attr:`unmatched_catalog_unit_vectors`,</span>
<span class="sd">        :attr:`unmatched_catalog_image_points`, and the</span>
<span class="sd">        :attr:`unmatched_extracted_image_points` arrays. </span>
<span class="sd">        </span>
<span class="sd">        Each object should be a :class:`~.psf_meta.PointSpreadFunction`.  </span>
<span class="sd">        See the documentation for the :mod:`.point_spread_functions` package for details.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_psfs</span>

    <span class="c1"># matched information</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">matched_catalog_star_records</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the star records queried from the star catalog that were matched with an image point of</span>
<span class="sd">        interest for each image in :attr:`camera` for the most recent star identification attempt (this gets</span>
<span class="sd">        overwritten when a new attempt is made at identifying the stars in the image)</span>

<span class="sd">        Each list element is a pandas DataFrame containing GIANT star records.  A GIANT star record has the following</span>
<span class="sd">        columns:</span>

<span class="sd">        ===================== ======== =================================================================================</span>
<span class="sd">        column                units    description</span>
<span class="sd">        ===================== ======== =================================================================================</span>
<span class="sd">        `&#39;ra&#39;`                deg      The right ascension of the star after correcting for proper motion</span>
<span class="sd">        `&#39;dec&#39;`               deg      The declination of the star after correcting for proper motion</span>
<span class="sd">        `&#39;distance&#39;`          km       The distance to the star from the Solar system barycenter (converted from</span>
<span class="sd">                                       parallax). This column has a default value of 5.428047027e15 if no parallax</span>
<span class="sd">                                       information is provided by the catalog.</span>
<span class="sd">        `&#39;ra_proper_motion&#39;`  deg/year The proper motion for the right ascension</span>
<span class="sd">        `&#39;dec_proper_motion&#39;` deg/year The proper motion for the declination</span>
<span class="sd">        `&#39;mag&#39;`               N/A      The apparent magnitude of the star according to the star catalog</span>
<span class="sd">        `&#39;ra_sigma&#39;`          deg      The formal uncertainty in the right ascension according to the catalog</span>
<span class="sd">        `&#39;dec_sigma&#39;`         deg      The formal uncertainty in the declination according to the catalog</span>
<span class="sd">        `&#39;distance_sigma&#39;`    km       The formal uncertainty in the distance according to the catalog</span>
<span class="sd">                                       (converted from parallax).  This has a default value of</span>
<span class="sd">                                       1.9949433041226756e+19 km for stars with no parallax information.</span>
<span class="sd">        `&#39;ra_pm_sigma&#39;`       deg/year The formal uncertainty in the right ascension proper motion according to</span>
<span class="sd">                                       the catalog</span>
<span class="sd">        `&#39;dec_pm_sigma&#39;`      deg/year The formal uncertainty in the declination proper motion according to the</span>
<span class="sd">                                       catalog</span>
<span class="sd">        ===================== ======== =================================================================================</span>

<span class="sd">        Each row of the data frame represents a star record. Each row of the DataFrame matches to the corresponding</span>
<span class="sd">        column in the :attr:`matched_catalog_unit_vectors_inertial`, :attr:`matched_catalog_unit_vectors_camera`,</span>
<span class="sd">        :attr:`matched_catalog_image_points`, and :attr:`matched_extracted_image_points` arrays, and the</span>
<span class="sd">        corresponding row in the :attr:`matched_image_illums` array.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>

<span class="sd">        If no stars have been successfully identified for an image then the corresponding index of the list will be set</span>
<span class="sd">        to ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_star_records</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">matched_catalog_image_points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the projections of the star records queried from the star catalog that were matched</span>
<span class="sd">        with an image point of interest for each image in :attr:`camera` from the most recent star identification</span>
<span class="sd">        attempt (this gets overwritten when a new attempt is made at identifying the stars in the image, and also when</span>
<span class="sd">        a new attitude is solved for the image).</span>

<span class="sd">        Each list element is a 2xn array of image points with the x locations (columns) down the first row and the y</span>
<span class="sd">        locations (rows) down the second row. Each column of the array matches to the corresponding column in the</span>
<span class="sd">        :attr:`matched_catalog_unit_vectors_inertial`, :attr:`matched_catalog_unit_vectors_camera`,</span>
<span class="sd">        and :attr:`matched_extracted_image_points` arrays, and the corresponding row in the :attr:`matched_image_illums`</span>
<span class="sd">        and :attr:`matched_catalog_star_records` arrays.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>

<span class="sd">        If no stars have been successfully identified for an image then the corresponding index of the list will be set</span>
<span class="sd">        to ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_image_points</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">matched_catalog_unit_vectors_inertial</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the inertial unit vectors of the star records queried from the star catalog that were</span>
<span class="sd">        matched with an image point of interest for each image in :attr:`camera` from the most recent star</span>
<span class="sd">        identification attempt (this gets overwritten when a new attempt is made at identifying the stars in the</span>
<span class="sd">        image). The unit vectors are the directions to the stars after correcting for</span>
<span class="sd">        proper motion, stellar aberration, and parallax.</span>

<span class="sd">        Each list element is a 3xn array of unit vectors with each unit vector stored as a column.</span>
<span class="sd">        Each column of the array matches to the corresponding column in the</span>
<span class="sd">        :attr:`matched_catalog_unit_vectors_camera`, :attr:`matched_catalog_image_points`,</span>
<span class="sd">        and :attr:`matched_extracted_image_points` arrays, and the corresponding rows in the</span>
<span class="sd">        :attr:`matched_image_illums` and :attr:`matched_catalog_star_records` arrays.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>

<span class="sd">        If no stars have been successfully identified for an image then the corresponding index of the list will be set</span>
<span class="sd">        to ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_inertial</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">matched_catalog_unit_vectors_camera</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the camera frame unit vectors of the star records queried from the star catalog that were</span>
<span class="sd">        matched with an image point of interest for each image in :attr:`camera` from the most recent star</span>
<span class="sd">        identification attempt (this gets overwritten when a new attempt is made at identifying the stars in the</span>
<span class="sd">        image). The unit vectors are the directions to the stars after correcting for</span>
<span class="sd">        proper motion, stellar aberration, and parallax.</span>

<span class="sd">        Each list element is a 3xn array of unit vectors with each unit vector stored as a column.</span>
<span class="sd">        Each column of the array matches to the corresponding column in the</span>
<span class="sd">        :attr:`matched_catalog_unit_vectors_inertial`, :attr:`matched_catalog_image_points`,</span>
<span class="sd">        and :attr:`matched_extracted_image_points` arrays, and the corresponding rows in the</span>
<span class="sd">        :attr:`matched_image_illums` and :attr:`matched_catalog_star_records` arrays.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>

<span class="sd">        If no stars have been successfully identified for an image then the corresponding index of the list will be set</span>
<span class="sd">        to ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_camera</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">matched_weights_inertial</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the uncertainty of all of the star records queried from the star catalog that were</span>
<span class="sd">        matched with an image point of interest for each image in :attr:`camera` from the most recent query to star</span>
<span class="sd">        catalog (this gets overwritten when the star catalog is re-queried for the image).  The uncertainties are</span>
<span class="sd">        based on the formal uncertainty of the star location according to the star catalog and are for the unit</span>
<span class="sd">        vector representation.</span>

<span class="sd">        A single value is provided for each unit vector representing the sum of the squares of the uncertainty (the</span>
<span class="sd">        trace of the covariance matrix). Each element of the array matches to the corresponding column in the</span>
<span class="sd">        :attr:`matched_catalog_image_points` array and the corresponding row in the</span>
<span class="sd">        :attr:`matched_catalog_star_records` DataFrame.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_inertial</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">matched_weights_picture</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the uncertainty of all of the star records queried from the star catalog that were</span>
<span class="sd">        matched with with an image point of interest for each image in :attr:`camera` from the most recent query to</span>
<span class="sd">        star catalog (this gets overwritten when the star catalog is re-queried for the image).  The</span>
<span class="sd">        uncertainties are based on the formal uncertainty of the star location according to the star catalog and</span>
<span class="sd">        are for the pixel representation of the star location.</span>

<span class="sd">        A single value is provided for each unit vector representing the sum of the squares of the uncertainty (the</span>
<span class="sd">        trace of the covariance matrix). Each element of the array matches to the corresponding column in the</span>
<span class="sd">        :attr:`matched_catalog_image_points` array and the corresponding row in the</span>
<span class="sd">        :attr:`matched_catalog_star_records` DataFrame.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_picture</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">matched_extracted_image_points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the image points of interest that are matched with a catalog star for each image in</span>
<span class="sd">        :attr:`camera` from the most recent star identification attempt (this gets overwritten when a new attempt is</span>
<span class="sd">        made at identifying the stars in the image).</span>

<span class="sd">        Each list element is a 2xn array of image points with the x locations (columns) down the first row and the y</span>
<span class="sd">        locations (rows) down the second row.  Each column of the array matches to the corresponding column in the</span>
<span class="sd">        :attr:`matched_catalog_unit_vectors_inertial`, :attr:`matched_catalog_unit_vectors_camera`,</span>
<span class="sd">        and :attr:`matched_catalog_image_points` arrays, and the corresponding row in the :attr:`matched_image_illums`</span>
<span class="sd">        and :attr:`matched_catalog_star_records` arrays.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>

<span class="sd">        If no stars have been successfully identified for an image then the corresponding index of the list will be set</span>
<span class="sd">        to ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_image_points</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">matched_image_illums</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">NDArray</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the DN values of the pixel containing the image points of interest that are matched with a</span>
<span class="sd">        catalog star for each image in :attr:`camera` from the most recent star identification attempt</span>
<span class="sd">        (this gets overwritten when a new attempt is made at identifying the stars in the image).</span>

<span class="sd">        Each list element is a length n array of image DN values. Each row of the array matches to the corresponding</span>
<span class="sd">        column in the :attr:`matched_catalog_unit_vectors_inertial`, :attr:`matched_catalog_unit_vectors_camera`,</span>
<span class="sd">        :attr:`matched_catalog_image_points`, and :attr:`matched_extracted_image_points` arrays, and the</span>
<span class="sd">        corresponding row in the :attr:`matched_catalog_star_records` DataFrame.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>

<span class="sd">        If no stars have been successfully identified for an image then the corresponding index of the list will be set</span>
<span class="sd">        to ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_image_illums</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">matched_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the connected component stats of each object that is matched with a</span>
<span class="sd">        catalog star for each image in :attr:`camera` from the most recent star identification attempt</span>
<span class="sd">        (this gets overwritten when a new attempt is made at identifying the stars in the image).</span>

<span class="sd">        Each list element is a length n array of opencv connect components statistics. Each row of the array matches to</span>
<span class="sd">        the corresponding column in the :attr:`matched_catalog_unit_vectors_inertial`,</span>
<span class="sd">        :attr:`matched_catalog_unit_vectors_camera`, :attr:`matched_catalog_image_points`, and</span>
<span class="sd">        :attr:`matched_extracted_image_points` arrays, and the corresponding row in the</span>
<span class="sd">        :attr:`matched_catalog_star_records` DataFrame.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>

<span class="sd">        If no stars have been successfully identified for an image then the corresponding index of the list will be set</span>
<span class="sd">        to ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_stats</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">matched_snrs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DOUBLE_ARRAY</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the peak snr value of each object that is matched with a</span>
<span class="sd">        catalog star for each image in :attr:`camera` from the most recent star identification attempt</span>
<span class="sd">        (this gets overwritten when a new attempt is made at identifying the stars in the image).</span>

<span class="sd">        Each list element is a length n array of opencv connect components statistics. Each row of the array matches to</span>
<span class="sd">        the corresponding column in the :attr:`matched_catalog_unit_vectors_inertial`,</span>
<span class="sd">        :attr:`matched_catalog_unit_vectors_camera`, :attr:`matched_catalog_image_points`, and</span>
<span class="sd">        :attr:`matched_extracted_image_points` arrays, and the corresponding row in the</span>
<span class="sd">        :attr:`matched_catalog_star_records` DataFrame.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>

<span class="sd">        If no stars have been successfully identified for an image then the corresponding index of the list will be set</span>
<span class="sd">        to ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_snrs</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">matched_psfs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">PointSpreadFunction</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This list contains the fit PSF objects for each matched image point from the most recent star identification</span>
<span class="sd">        attempt (this gets overwritten when a new attempt is made at identifying the stars in the image).</span>

<span class="sd">        This list is only updated if :attr:`.ImageProcessing.save_psf` is set to ``True``.</span>

<span class="sd">        Each list element is a shape n array of PSF objects. Each element of the array matches to the corresponding</span>
<span class="sd">        column in the :attr:`matched_catalog_unit_vectors_inertial`, :attr:`matched_catalog_unit_vectors_camera`,</span>
<span class="sd">        :attr:`matched_catalog_image_points`, and :attr:`matched_extracted_image_points` arrays, and the corresponding</span>
<span class="sd">        row in the :attr:`matched_catalog_star_records` DataFrame.  The PSF object in each element is the same type as</span>
<span class="sd">        :attr:`.ImageProcessing.centroiding`.  See the documentation for the :mod:`.point_spread_functions` package for</span>
<span class="sd">        details.</span>

<span class="sd">        This list should always be the same length as the :attr:`.Camera.images` list and each element of this list</span>
<span class="sd">        corresponds to the image in the same element in the :attr:`.Camera.images` list.</span>

<span class="sd">        If no stars have been successfully identified for an image then the corresponding index of the list will be set</span>
<span class="sd">        to ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_psfs</span>

    <span class="c1"># ____________________________________________________ METHODS ________________________________________________</span>

<div class="viewcode-block" id="StellarOpNav.reset_star_id">
<a class="viewcode-back" href="../../../stellar_opnav/stellar_class/giant.stellar_opnav.stellar_class.StellarOpNav.reset_star_id.html#giant.stellar_opnav.stellar_class.StellarOpNav.reset_star_id">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">reset_star_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method resets the star_id object to it original settings at initialization</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">reset_settings</span><span class="p">()</span>
        <span class="c1"># ensure the model is right</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">model</span></div>


<div class="viewcode-block" id="StellarOpNav.update_star_id">
<a class="viewcode-back" href="../../../stellar_opnav/stellar_class/giant.stellar_opnav.stellar_class.StellarOpNav.update_star_id.html#giant.stellar_opnav.stellar_class.StellarOpNav.update_star_id">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_star_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">star_id_update</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">StarIDOptions</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method updates the attributes of the :attr:`star_id` attribute with new settings from a :class:`.StarIDOptions`.</span>

<span class="sd">        :param star_id_update: The options struct to update the star_id instance using</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">star_id_update</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">star_id_update</span><span class="o">.</span><span class="n">apply_options</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="p">)</span></div>


<div class="viewcode-block" id="StellarOpNav.reset_point_of_interest_finder">
<a class="viewcode-back" href="../../../stellar_opnav/stellar_class/giant.stellar_opnav.stellar_class.StellarOpNav.reset_point_of_interest_finder.html#giant.stellar_opnav.stellar_class.StellarOpNav.reset_point_of_interest_finder">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">reset_point_of_interest_finder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method resets the settings for the point of interest finder to their original values at initialization.</span>

<span class="sd">        This method also updates all of the elements of :attr:`process_stars` to ``True``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_poi_finder</span><span class="o">.</span><span class="n">reset_settings</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_reset_process_stars</span><span class="p">()</span></div>


<div class="viewcode-block" id="StellarOpNav.update_point_of_interest_finder">
<a class="viewcode-back" href="../../../stellar_opnav/stellar_class/giant.stellar_opnav.stellar_class.StellarOpNav.update_point_of_interest_finder.html#giant.stellar_opnav.stellar_class.StellarOpNav.update_point_of_interest_finder">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_point_of_interest_finder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point_of_interest_finder_update</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PointOfInterestFinderOptions</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method updates the attributes of the :attr:`point_of_interest_finder` attribute.</span>

<span class="sd">        This method also updates all of the elements of :attr:`process_stars` to ``True``.</span>

<span class="sd">        :param point_of_interest_finder_update: An instance of :class:`.PointOfInterestFinderOptions` containing the new settings</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">point_of_interest_finder_update</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">point_of_interest_finder_update</span><span class="o">.</span><span class="n">apply_options</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_poi_finder</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_reset_process_stars</span><span class="p">()</span></div>


<div class="viewcode-block" id="StellarOpNav.reset_attitude_estimator">
<a class="viewcode-back" href="../../../stellar_opnav/stellar_class/giant.stellar_opnav.stellar_class.StellarOpNav.reset_attitude_estimator.html#giant.stellar_opnav.stellar_class.StellarOpNav.reset_attitude_estimator">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">reset_attitude_estimator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method resets the settings for the attitude_estimator to the original settings used at initialization.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_attitude_est</span><span class="o">.</span><span class="n">reset_settings</span><span class="p">()</span></div>

        
<div class="viewcode-block" id="StellarOpNav.update_attitude_estimator">
<a class="viewcode-back" href="../../../stellar_opnav/stellar_class/giant.stellar_opnav.stellar_class.StellarOpNav.update_attitude_estimator.html#giant.stellar_opnav.stellar_class.StellarOpNav.update_attitude_estimator">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_attitude_estimator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attitude_estimator_update</span><span class="p">:</span> <span class="n">AttitudeEstimatorOptions</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method updates the attributes of the :attr:`attitude_estimator` attribute.</span>

<span class="sd">        :param attitude_estimator_update: An instance of :class:`.AttitudeEstimatorOptions`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">attitude_estimator_update</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attitude_estimator_update</span><span class="o">.</span><span class="n">apply_options</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attitude_est</span><span class="p">)</span></div>


<div class="viewcode-block" id="StellarOpNav.id_stars">
<a class="viewcode-back" href="../../../stellar_opnav/stellar_class/giant.stellar_opnav.stellar_class.StellarOpNav.id_stars.html#giant.stellar_opnav.stellar_class.StellarOpNav.id_stars">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">id_stars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method identifies stars for each image turned on in the :attr:`camera` attribute.</span>

<span class="sd">        The steps for performing the star identification are as follows:</span>

<span class="sd">        #. Potential star locations are extracted from each image using the</span>
<span class="sd">           :meth:`.ImageProcessing.locate_subpixel_poi_in_roi` method for each image (if this step has not been already</span>
<span class="sd">           performed).  The subpixel points of interest from this step are then passed to the :class:`.StarID` object</span>
<span class="sd">           as the :attr:`.StarID.extracted_image_points` attribute.</span>
<span class="sd">        #. The :class:`.StarID` object is further updated with the *a priori* attitude, the camera position and</span>
<span class="sd">           velocity, and the observation date for each image.</span>
<span class="sd">        #. The stars are identified using the routines in the :meth:`.StarID.id_stars` method.</span>
<span class="sd">        #. The results from the star identification are stored into the various properties of this</span>
<span class="sd">           class for each image.</span>

<span class="sd">        For more information about the star identification process see the :class:`.StarID` documentation</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">image_count_index</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">number_of_images</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">image_mask</span><span class="p">)</span>
        <span class="c1"># walk through each turned on image</span>
        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">image</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="p">:</span>

            <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

            <span class="c1"># if we need to reprocess the stars then send them through the image processing pipeline</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_stars</span><span class="p">[</span><span class="n">ind</span><span class="p">]:</span>
                <span class="c1"># extract subpixel points of interest as potential star locations</span>
                
                <span class="c1"># check if we need to apply denoising</span>
                <span class="n">use_image</span> <span class="o">=</span> <span class="n">image</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">denoising</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">use_image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">denoising</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
                    
                <span class="c1"># do the image processing</span>
                <span class="n">poi_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_poi_finder</span><span class="p">(</span><span class="n">use_image</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_image_illums</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">poi_results</span><span class="o">.</span><span class="n">centroid_intensity</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">poi_results</span><span class="o">.</span><span class="n">centroids</span><span class="o">.</span><span class="n">T</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_psfs</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">poi_results</span><span class="o">.</span><span class="n">point_spread_functions</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_snrs</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">poi_results</span><span class="o">.</span><span class="n">peak_snr</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_stats</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">poi_results</span><span class="o">.</span><span class="n">stats</span>
                
                <span class="c1"># discard points inside of extended bodies)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
                        
                        <span class="c1"># create rays to shoot through the identified points</span>
                        <span class="n">rays</span> <span class="o">=</span> <span class="n">Rays</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">pixels_to_unit</span><span class="p">(</span><span class="n">poi_results</span><span class="o">.</span><span class="n">centroids</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">image</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">ind</span><span class="p">))</span>
                        
                        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rays</span><span class="p">)</span>
                        
                        <span class="n">interior</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;check&#39;</span><span class="p">]</span>
                        
                        <span class="c1"># throw out interior points</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">poi_results</span><span class="o">.</span><span class="n">centroids</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="o">~</span><span class="n">interior</span><span class="p">]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_image_illums</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">poi_results</span><span class="o">.</span><span class="n">centroid_intensity</span><span class="p">[</span><span class="o">~</span><span class="n">interior</span><span class="p">]</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_stats</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">poi_results</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="o">~</span><span class="n">interior</span><span class="p">]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_snrs</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">poi_results</span><span class="o">.</span><span class="n">peak_snr</span><span class="p">[</span><span class="o">~</span><span class="n">interior</span><span class="p">]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_psfs</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">boolean_filter_list</span><span class="p">(</span><span class="n">poi_results</span><span class="o">.</span><span class="n">point_spread_functions</span><span class="p">,</span> <span class="n">interior</span><span class="p">)</span>


                <span class="c1"># set a flag saying that we don&#39;t need to pass this image through the image processing again</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">process_stars</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="c1"># supply the star id class with the proper information</span>
            <span class="n">e_image_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
            <span class="k">assert</span> <span class="n">e_image_points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            
            <span class="c1"># identify the stars</span>
            <span class="n">keep_stars</span><span class="p">,</span> <span class="n">keep_inliers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">id_stars</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">e_image_points</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
                                                              <span class="n">image_number</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span>
            <span class="c1"># store the required information</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_star_records</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">queried_catalog_star_records</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">queried_catalog_image_points</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_unit_vectors</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">queried_catalog_unit_vectors</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_star_records</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">unmatched_catalog_star_records</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">unmatched_catalog_image_points</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_unit_vectors</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">unmatched_catalog_unit_vectors</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">unmatched_extracted_image_points</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_weights</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_queried_weights_inertial</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">queried_weights_inertial</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_queried_weights_picture</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">queried_weights_picture</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_weights_inertial</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">unmatched_weights_inertial</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_weights_picture</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">unmatched_weights_picture</span>

            <span class="c1"># if we didn&#39;t identify any stars then set the matched variables to None</span>
            <span class="k">if</span> <span class="n">keep_inliers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_star_records</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_inertial</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_camera</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_image_illums</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_psfs</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_psfs</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_stats</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_snrs</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_stats</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_stats</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_snrs</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_snrs</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_weights</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_inertial</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_picture</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">keep_stars</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="n">full_filter</span> <span class="o">=</span> <span class="n">keep_stars</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">full_filter</span><span class="p">[</span><span class="n">keep_stars</span><span class="p">]</span> <span class="o">=</span> <span class="n">keep_inliers</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_star_records</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">matched_catalog_star_records</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">matched_catalog_image_points</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_inertial</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">matched_catalog_unit_vectors</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_camera</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span>
                    <span class="n">image</span><span class="o">.</span><span class="n">rotation_inertial_to_camera</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_inertial</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="c1"># type: ignore</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">matched_extracted_image_points</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_image_illums</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_image_illums</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="n">full_filter</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># type: ignore</span>
                <span class="n">full_filter</span><span class="p">[</span><span class="n">keep_stars</span><span class="p">]</span> <span class="o">=</span> <span class="n">keep_inliers</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_psfs</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">boolean_filter_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extracted_psfs</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">full_filter</span><span class="p">)</span> <span class="c1"># type: ignore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_psfs</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">boolean_filter_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extracted_psfs</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="o">~</span><span class="n">full_filter</span><span class="p">)</span> <span class="c1"># type: ignore</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_weights</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_inertial</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">matched_weights_inertial</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_picture</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_star_id</span><span class="o">.</span><span class="n">matched_weights_picture</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_stats</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_stats</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="n">full_filter</span><span class="p">]</span> <span class="c1"># type: ignore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_snrs</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_snrs</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="n">full_filter</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_stats</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_stats</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="o">~</span><span class="n">full_filter</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_snrs</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_snrs</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="o">~</span><span class="n">full_filter</span><span class="p">]</span>  <span class="c1"># type: ignore</span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;image </span><span class="si">{}</span><span class="s1"> of </span><span class="si">{}</span><span class="s1"> done in </span><span class="si">{:.4g}</span><span class="s1"> seconds&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">image_count_index</span><span class="p">,</span> <span class="n">number_of_images</span><span class="p">,</span>
                                                                 <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">),</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">image_count_index</span> <span class="o">+=</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="StellarOpNav.reproject_stars">
<a class="viewcode-back" href="../../../stellar_opnav/stellar_class/giant.stellar_opnav.stellar_class.StellarOpNav.reproject_stars.html#giant.stellar_opnav.stellar_class.StellarOpNav.reproject_stars">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">reproject_stars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method updates the unit vectors and reprojects the stars using updated camera and attitude models.</span>

<span class="sd">        The following are updated:</span>

<span class="sd">        * :attr:`matched_catalog_unit_vectors_camera`</span>
<span class="sd">        * :attr:`matched_catalog_image_points`</span>
<span class="sd">        * :attr:`queried_catalog_image_points`</span>
<span class="sd">        * :attr:`unmatched_catalog_image_points`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">image</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_inertial</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No stars identified for image </span><span class="si">{0}</span><span class="s2">.</span><span class="se">\n</span><span class="s2"> Cannot perform update&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ind</span><span class="p">))</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_camera</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span>
                    <span class="n">image</span><span class="o">.</span><span class="n">rotation_inertial_to_camera</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_inertial</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="c1"># type: ignore</span>
                <span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">project_onto_image</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_camera</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">image</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">image</span><span class="o">.</span><span class="n">temperature</span> <span class="c1"># type: ignore</span>
                <span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">project_onto_image</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">rotation_inertial_to_camera</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_unit_vectors</span><span class="p">[</span><span class="n">ind</span><span class="p">]),</span> <span class="c1"># type: ignore</span>
                    <span class="n">image</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">image</span><span class="o">.</span><span class="n">temperature</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">project_onto_image</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">rotation_inertial_to_camera</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_unit_vectors</span><span class="p">[</span><span class="n">ind</span><span class="p">]),</span> <span class="c1"># type: ignore</span>
                    <span class="n">image</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">image</span><span class="o">.</span><span class="n">temperature</span>
                <span class="p">)</span></div>


<div class="viewcode-block" id="StellarOpNav.estimate_attitude">
<a class="viewcode-back" href="../../../stellar_opnav/stellar_class/giant.stellar_opnav.stellar_class.StellarOpNav.estimate_attitude.html#giant.stellar_opnav.stellar_class.StellarOpNav.estimate_attitude">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_attitude</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method estimates an updated attitude for each image based on the identified stars in the image.</span>

<span class="sd">        For each turned on image in the :attr:`camera` attribute this method provides the attitude estimation routines</span>
<span class="sd">        with the :attr:`matched_catalog_unit_vectors_inertial`, and the camera frame unit vectors corresponding to the</span>
<span class="sd">        :attr:`matched_extracted_image_points`.  The :meth:`~.AttitudeEstimator.estimate()` method of the attitude</span>
<span class="sd">        estimation class is then called, and the resulting solved for rotation is stored as the</span>
<span class="sd">        :attr:`.rotation_inertial_to_camera` attribute for each image. Finally, the updated attitude information is</span>
<span class="sd">        used to update the following:</span>

<span class="sd">        * :attr:`matched_catalog_unit_vectors_camera`</span>
<span class="sd">        * :attr:`matched_catalog_image_points`</span>
<span class="sd">        * :attr:`queried_catalog_image_points`</span>
<span class="sd">        * :attr:`unmatched_catalog_image_points`</span>

<span class="sd">        The unit vectors in the camera frame for the matched image points are determined using the</span>
<span class="sd">        :meth:`~.CameraModel.pixels_to_unit` method of the camera model.</span>

<span class="sd">        For a more thorough description of the attitude estimation routine see the</span>
<span class="sd">        :mod:`.stellar_opnav.estimators` documentation.</span>

<span class="sd">        When attitude estimation is successful for an image (that is it was attempted and didn&#39;t error), then the</span>
<span class="sd">        :attr:`.OpNavImage.pointing_post_fit` flag is updated to ``True``.  When attitude estimation isn&#39;t successful</span>
<span class="sd">        for an image (it wasn&#39;t attempted due to a lack of stars or it failed) the the</span>
<span class="sd">        :attr:`.OpNavImage.pointing_post_fit` is set to ``False``</span>

<span class="sd">        .. warning::</span>
<span class="sd">            This method overwrites the attitude information in the :attr:`.rotation_inertial_to_camera` attribute and</span>
<span class="sd">            does not save old information anywhere.  If you want this information saved be sure to store it yourself</span>
<span class="sd">            for each image.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">image</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_inertial</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No stars identified for image </span><span class="si">{0}</span><span class="s2">.</span><span class="se">\n</span><span class="s2"> Cannot perform attitude estimation&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ind</span><span class="p">))</span>
                <span class="n">image</span><span class="o">.</span><span class="n">pointing_post_fit</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_inertial</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span> <span class="c1"># type: ignore</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Not enough stars identified for image </span><span class="si">{0}</span><span class="s2">.</span><span class="se">\n</span><span class="s2"> &quot;</span>
                              <span class="s2">&quot;Cannot perform attitude estimation&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ind</span><span class="p">))</span>
                <span class="n">image</span><span class="o">.</span><span class="n">pointing_post_fit</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">base_frame_directions</span><span class="p">:</span> <span class="n">DOUBLE_ARRAY</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_inertial</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>   <span class="c1"># type: ignore</span>
                <span class="n">target_frame_directions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">pixels_to_unit</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">image</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">image</span><span class="o">.</span><span class="n">temperature</span> <span class="c1"># type: ignore</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_weights</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attitude_est</span><span class="o">.</span><span class="n">weighted_estimation</span><span class="p">,</span> <span class="s1">&#39;weighted_estimation must be True in the estimator is use_weights is True&#39;</span>
                    <span class="n">weights</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_inertial</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="c1"># type: ignore</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">weights</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="n">estimated_rotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attitude_est</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">target_frame_directions</span><span class="p">,</span> <span class="n">base_frame_directions</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
                
                <span class="n">image</span><span class="o">.</span><span class="n">rotation_inertial_to_camera</span> <span class="o">=</span> <span class="n">estimated_rotation</span>
                <span class="n">image</span><span class="o">.</span><span class="n">pointing_post_fit</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">reproject_stars</span><span class="p">()</span></div>


    <span class="c1"># noinspection PyTypeChecker</span>
<div class="viewcode-block" id="StellarOpNav.sid_summary">
<a class="viewcode-back" href="../../../stellar_opnav/stellar_class/giant.stellar_opnav.stellar_class.StellarOpNav.sid_summary.html#giant.stellar_opnav.stellar_class.StellarOpNav.sid_summary">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">sid_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method generate a summary of the star identification results overall and for each image and prints it to</span>
<span class="sd">        stdout.</span>

<span class="sd">        The summary is a fixed width table with the following columns</span>
<span class="sd">        date, queried, q inside, q outside, poi, matched, m inside, m outside, unmatched q, u q inside, u</span>
<span class="sd">        q outside, u poi. The meaning of each column is specified in the following table:</span>

<span class="sd">        =============== ================================================================================================</span>
<span class="sd">        column          description</span>
<span class="sd">        =============== ================================================================================================</span>
<span class="sd">        ``date``        The UTC observation date for the image this line corresponds to</span>
<span class="sd">        ``queried``     The total number of stars that were queried from the catalog</span>
<span class="sd">        ``q inside``    The number of queried catalog stars that were within the FOV of the camera</span>
<span class="sd">        ``q outside``   The number of queried catalog stars that were outside the FOV of the camera</span>
<span class="sd">        ``poi``         The total number of points of interest that were identified in the image by the image processing</span>
<span class="sd">                        algorithms</span>
<span class="sd">        ``matched``     The total number of matched (identified) stars</span>
<span class="sd">        ``m inside``    The number of matched stars that fall within the field of view of the camera using the current</span>
<span class="sd">                        attitude</span>
<span class="sd">        ``m outside``   The number of matched stars that fall outside of the field of view of the camera using the</span>
<span class="sd">                        current attitude</span>
<span class="sd">        ``unmatched q`` The total number of unmatched catalog locations</span>
<span class="sd">        ``u q inside``  The number of unmatched catalog locations that fall inside of the field of view of the camera</span>
<span class="sd">                        using the current attitude</span>
<span class="sd">        ``u q outside`` The number of unmatched catalog locations that fall outside of the field of view of the camera</span>
<span class="sd">                        using the current attitude</span>
<span class="sd">        ``u poi``       The number of points of interested that where identified by the image processing routines in the</span>
<span class="sd">                        image that were not matched with a catalog star.</span>
<span class="sd">        =============== ================================================================================================</span>

<span class="sd">        This method also prints out a total row which sums each column using the same format.</span>

<span class="sd">        There is one optional input for this method, ``width`` which specifies the width for each column of the table.</span>
<span class="sd">        You should not set this below 15 due to the length of the UTC date strings</span>

<span class="sd">        :param width:  The width of the fixed width table columns in characters</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># initialize the sum variables</span>
        <span class="n">total_queried</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_inside_fov</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_outside_fov</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_extracted_image_points</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_matched</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_matched_inside_fov</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_matched_outside_fov</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_catalog_unmatched</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_catalog_unmatched_inside_fov</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_catalog_unmatched_outside_fov</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_image_poi_unmatched</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># form and print the header</span>
        <span class="n">header</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;{:^&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">width</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;} &#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;queried&#39;</span><span class="p">,</span> <span class="s1">&#39;q inside&#39;</span><span class="p">,</span> <span class="s1">&#39;q outside&#39;</span><span class="p">,</span>
                                                           <span class="s1">&#39;poi&#39;</span><span class="p">,</span> <span class="s1">&#39;matched&#39;</span><span class="p">,</span> <span class="s1">&#39;m inside&#39;</span><span class="p">,</span> <span class="s1">&#39;m outside&#39;</span><span class="p">,</span>
                                                           <span class="s1">&#39;unmatched q&#39;</span><span class="p">,</span> <span class="s1">&#39;u q inside&#39;</span><span class="p">,</span> <span class="s1">&#39;u q outside&#39;</span><span class="p">,</span>
                                                           <span class="s1">&#39;u poi&#39;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>

        <span class="c1"># form the template for the data rows</span>
        <span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;{:^&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">width</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;} &#39;</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;{:^&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">width</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;d} &#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">11</span>

        <span class="c1"># loop through each turned on image</span>
        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">image</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="p">:</span>

            <span class="c1"># get the number of queried stars inside and outside the field of view)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_star_records</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">number_queried</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">number_inside_fov</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">number_outside_fov</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">number_queried</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_star_records</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># type: ignore</span>
                <span class="n">inside_fov</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="c1"># type: ignore</span>
                              <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">n_cols</span><span class="p">],</span> <span class="c1"># type: ignore</span>
                                                                             <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">n_rows</span><span class="p">]]))</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

                <span class="n">number_inside_fov</span> <span class="o">=</span> <span class="n">inside_fov</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                <span class="n">number_outside_fov</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">inside_fov</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

            <span class="c1"># get the number of image points</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">number_extracted_image_points</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">number_extracted_image_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># type: ignore</span>

            <span class="c1"># get the number of matched points</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">number_matched</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># type: ignore</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">number_matched</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># get the number of unmatched stars inside and outside the field of view</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_star_records</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">number_unmatched_catalog</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">number_unmatched_catalog_inside_fov</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">number_unmatched_catalog_outside_fov</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">number_unmatched_catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_star_records</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># type: ignore</span>
                <span class="n">unmatched_catalog_inside_fov</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="c1"># type: ignore</span>
                        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">n_cols</span><span class="p">],</span> <span class="c1"># type: ignore</span>
                                                                         <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">n_rows</span><span class="p">]])</span>
                <span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

                <span class="n">number_unmatched_catalog_inside_fov</span> <span class="o">=</span> <span class="n">unmatched_catalog_inside_fov</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                <span class="n">number_unmatched_catalog_outside_fov</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">unmatched_catalog_inside_fov</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

            <span class="c1"># get the number of matched stars inside and outside the field of view</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">number_matched_catalog_inside_fov</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">number_matched_catalog_outside_fov</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">matched_catalog_inside_fov</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="c1"># type: ignore</span>
                        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">n_cols</span><span class="p">],</span> <span class="c1"># type: ignore</span>
                                                                       <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">n_rows</span><span class="p">]])</span>
                <span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

                <span class="n">number_matched_catalog_inside_fov</span> <span class="o">=</span> <span class="n">matched_catalog_inside_fov</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                <span class="n">number_matched_catalog_outside_fov</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">matched_catalog_inside_fov</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

            <span class="c1"># get the number of unmatched points</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">number_unmatched_poi</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">number_unmatched_poi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_image_points</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># type: ignore</span>

            <span class="c1"># print the row for the current image</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">observation_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%y %H:%M&#39;</span><span class="p">),</span> <span class="n">number_queried</span><span class="p">,</span> <span class="n">number_inside_fov</span><span class="p">,</span>
                                  <span class="n">number_outside_fov</span><span class="p">,</span>
                                  <span class="n">number_extracted_image_points</span><span class="p">,</span> <span class="n">number_matched</span><span class="p">,</span> <span class="n">number_matched_catalog_inside_fov</span><span class="p">,</span>
                                  <span class="n">number_matched_catalog_outside_fov</span><span class="p">,</span> <span class="n">number_unmatched_catalog</span><span class="p">,</span>
                                  <span class="n">number_unmatched_catalog_inside_fov</span><span class="p">,</span> <span class="n">number_unmatched_catalog_outside_fov</span><span class="p">,</span>
                                  <span class="n">number_unmatched_poi</span><span class="p">))</span>

            <span class="c1"># update the totals</span>
            <span class="n">total_queried</span> <span class="o">+=</span> <span class="n">number_queried</span>
            <span class="n">total_inside_fov</span> <span class="o">+=</span> <span class="n">number_inside_fov</span>
            <span class="n">total_outside_fov</span> <span class="o">+=</span> <span class="n">number_outside_fov</span>
            <span class="n">total_extracted_image_points</span> <span class="o">+=</span> <span class="n">number_extracted_image_points</span>
            <span class="n">total_matched</span> <span class="o">+=</span> <span class="n">number_matched</span>
            <span class="n">total_matched_inside_fov</span> <span class="o">+=</span> <span class="n">number_matched_catalog_inside_fov</span>
            <span class="n">total_matched_outside_fov</span> <span class="o">+=</span> <span class="n">number_matched_catalog_outside_fov</span>
            <span class="n">total_catalog_unmatched</span> <span class="o">+=</span> <span class="n">number_unmatched_catalog</span>
            <span class="n">total_catalog_unmatched_inside_fov</span> <span class="o">+=</span> <span class="n">number_unmatched_catalog_inside_fov</span>
            <span class="n">total_catalog_unmatched_outside_fov</span> <span class="o">+=</span> <span class="n">number_unmatched_catalog_outside_fov</span>
            <span class="n">total_image_poi_unmatched</span> <span class="o">+=</span> <span class="n">number_unmatched_poi</span>

        <span class="c1"># print the total row</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;total&#39;</span><span class="p">,</span> <span class="n">total_queried</span><span class="p">,</span> <span class="n">total_inside_fov</span><span class="p">,</span> <span class="n">total_outside_fov</span><span class="p">,</span>
                              <span class="n">total_extracted_image_points</span><span class="p">,</span> <span class="n">total_matched</span><span class="p">,</span> <span class="n">total_matched_inside_fov</span><span class="p">,</span>
                              <span class="n">total_matched_outside_fov</span><span class="p">,</span> <span class="n">total_catalog_unmatched</span><span class="p">,</span>
                              <span class="n">total_catalog_unmatched_inside_fov</span><span class="p">,</span> <span class="n">total_catalog_unmatched_outside_fov</span><span class="p">,</span>
                              <span class="n">total_image_poi_unmatched</span><span class="p">))</span></div>


    <span class="c1"># noinspection PyTypeChecker</span>
<div class="viewcode-block" id="StellarOpNav.matched_star_residuals">
<a class="viewcode-back" href="../../../stellar_opnav/stellar_class/giant.stellar_opnav.stellar_class.StellarOpNav.matched_star_residuals.html#giant.stellar_opnav.stellar_class.StellarOpNav.matched_star_residuals">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">matched_star_residuals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_num</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NONEARRAY</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method calculates the residuals for matched stars for a given image number in the :attr:`camera` attribute.</span>

<span class="sd">        :param image_num: The index of the image in the :attr:`camera` attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_image_points</span><span class="p">[</span><span class="n">image_num</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No stars identified for image </span><span class="si">{0}</span><span class="s2">.</span><span class="se">\n</span><span class="s2"> Cannot calculate residuals&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">image_num</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cat_locs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_image_points</span><span class="p">[</span><span class="n">image_num</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
            <span class="k">return</span> <span class="n">cat_locs</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_image_points</span><span class="p">[</span><span class="n">image_num</span><span class="p">]</span></div>


    <span class="c1"># noinspection PyUnresolvedReferences</span>
<div class="viewcode-block" id="StellarOpNav.remove_matched_stars">
<a class="viewcode-back" href="../../../stellar_opnav/stellar_class/giant.stellar_opnav.stellar_class.StellarOpNav.remove_matched_stars.html#giant.stellar_opnav.stellar_class.StellarOpNav.remove_matched_stars">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">remove_matched_stars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_num</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">star_indices</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">]</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method removes specified matched stars for a given image number in the :attr:`camera` attribute.</span>

<span class="sd">        This method updates the following:</span>

<span class="sd">        * :attr:`matched_catalog_star_records`</span>
<span class="sd">        * :attr:`matched_catalog_image_points`</span>
<span class="sd">        * :attr:`matched_catalog_unit_vectors_inertial`</span>
<span class="sd">        * :attr:`matched_catalog_unit_vectors_camera`</span>
<span class="sd">        * :attr:`matched_extracted_image_points`</span>
<span class="sd">        * :attr:`matched_image_illums`</span>
<span class="sd">        * :attr:`matched_stats`</span>
<span class="sd">        * :attr:`matched_snrs`</span>
<span class="sd">        * :attr:`matched_psfs`</span>
<span class="sd">        * :attr:`matched_weights_inertial`</span>
<span class="sd">        * :attr:`matched_weights_picture`</span>

<span class="sd">        :param image_num: The index of the image in the :attr:`camera` attribute.</span>
<span class="sd">        :param star_indices: The list of indices of matched stars to be removed from the specified image in the</span>
<span class="sd">                             :attr:`camera` attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_image_points</span><span class="p">[</span><span class="n">image_num</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No stars identified for image </span><span class="si">{0}</span><span class="s2">.</span><span class="se">\n</span><span class="s2"> Cannot remove matched stars&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">image_num</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">indices_desired</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_image_points</span><span class="p">[</span><span class="n">image_num</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span> <span class="c1"># type: ignore</span>
            <span class="n">indices_desired</span><span class="p">[</span><span class="n">star_indices</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_image_points</span><span class="p">[</span><span class="n">image_num</span><span class="p">]</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_image_points</span><span class="p">[</span><span class="n">image_num</span><span class="p">][:,</span> <span class="n">indices_desired</span><span class="p">]</span> <span class="c1"># type: ignore</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_camera</span><span class="p">[</span><span class="n">image_num</span><span class="p">]</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_camera</span><span class="p">[</span><span class="n">image_num</span><span class="p">][:,</span> <span class="n">indices_desired</span><span class="p">]</span> <span class="c1"># type: ignore</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_inertial</span><span class="p">[</span><span class="n">image_num</span><span class="p">]</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_inertial</span><span class="p">[</span><span class="n">image_num</span><span class="p">][:,</span> <span class="n">indices_desired</span><span class="p">]</span> <span class="c1"># type: ignore</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_star_records</span><span class="p">[</span><span class="n">image_num</span><span class="p">]</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_star_records</span><span class="p">[</span><span class="n">image_num</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">indices_desired</span><span class="p">]</span> <span class="c1"># type: ignore</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_image_points</span><span class="p">[</span><span class="n">image_num</span><span class="p">]</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_image_points</span><span class="p">[</span><span class="n">image_num</span><span class="p">][:,</span> <span class="n">indices_desired</span><span class="p">]</span> <span class="c1"># type: ignore</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_image_illums</span><span class="p">[</span><span class="n">image_num</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_image_illums</span><span class="p">[</span><span class="n">image_num</span><span class="p">][</span><span class="n">indices_desired</span><span class="p">]</span> <span class="c1"># type: ignore</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_snrs</span><span class="p">[</span><span class="n">image_num</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_snrs</span><span class="p">[</span><span class="n">image_num</span><span class="p">][</span><span class="n">indices_desired</span><span class="p">]</span> <span class="c1"># type: ignore</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_stats</span><span class="p">[</span><span class="n">image_num</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_stats</span><span class="p">[</span><span class="n">image_num</span><span class="p">][</span><span class="n">indices_desired</span><span class="p">]</span> <span class="c1"># type: ignore</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_psfs</span><span class="p">[</span><span class="n">image_num</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_matched_psfs</span><span class="p">[</span><span class="n">image_num</span><span class="p">][</span><span class="n">desired</span><span class="p">]</span> <span class="k">for</span> <span class="n">desired</span> <span class="ow">in</span> <span class="n">star_indices</span><span class="p">]</span> <span class="c1"># type: ignore</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_inertial</span><span class="p">[</span><span class="n">image_num</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_inertial</span><span class="p">[</span><span class="n">image_num</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_inertial</span><span class="p">[</span><span class="n">image_num</span><span class="p">][</span><span class="n">indices_desired</span><span class="p">]</span> <span class="c1"># type: ignore</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_picture</span><span class="p">[</span><span class="n">image_num</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_picture</span><span class="p">[</span><span class="n">image_num</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_picture</span><span class="p">[</span><span class="n">image_num</span><span class="p">][</span><span class="n">indices_desired</span><span class="p">]</span> <span class="c1"># type: ignore</span></div>


    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_outliers</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">sigma_cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">hard_threshold</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get possible outliers using both a Median Absolute Deviation (MAD) check and a hard threshold check.</span>

<span class="sd">        :param data: The data to check for outliers</span>
<span class="sd">        :param sigma_cutoff: The sigma value for the MAD check</span>
<span class="sd">        :param hard_threshold: The hard threshold to use on the norm of the residuals</span>
<span class="sd">        :return: A boolean array of possible outliers</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">x_outliers</span> <span class="o">=</span> <span class="n">get_outliers</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sigma_cutoff</span><span class="o">=</span><span class="n">sigma_cutoff</span><span class="p">)</span>
        <span class="n">y_outliers</span> <span class="o">=</span> <span class="n">get_outliers</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sigma_cutoff</span><span class="o">=</span><span class="n">sigma_cutoff</span><span class="p">)</span>

        <span class="n">total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">total_outliers</span> <span class="o">=</span> <span class="n">get_outliers</span><span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="n">sigma_cutoff</span><span class="o">=</span><span class="n">sigma_cutoff</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">x_outliers</span> <span class="o">|</span> <span class="n">y_outliers</span> <span class="o">|</span> <span class="n">total_outliers</span> <span class="o">|</span> <span class="p">(</span><span class="n">total</span> <span class="o">&gt;=</span> <span class="n">hard_threshold</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_review_image_outliers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_num</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">sigma_cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">hard_threshold</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method identifies potential outliers for the specified image and shows the possible outliers to the user</span>
<span class="sd">        for manual review.</span>

<span class="sd">        Any outliers the user chooses to remove will be returned as a list of the indices of the removed outliers</span>

<span class="sd">        :param image_num: image number</span>
<span class="sd">        :return: The indices to remove within image</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">giant.stellar_opnav.visualizers</span><span class="w"> </span><span class="kn">import</span> <span class="n">show_outlier</span>

        <span class="n">indices_to_remove</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matched_star_residuals</span><span class="p">(</span><span class="n">image_num</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">residuals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">outliers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_outliers</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">sigma_cutoff</span><span class="p">,</span> <span class="n">hard_threshold</span><span class="p">)</span>

        <span class="c1"># Plot stars with residuals above threshold</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
            <span class="k">if</span> <span class="n">outliers</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">shown_outlier</span> <span class="o">=</span> <span class="n">show_outlier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">image_num</span><span class="p">,</span> <span class="n">residuals</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">shown_outlier</span><span class="o">.</span><span class="n">removed</span><span class="p">:</span>
                    <span class="n">indices_to_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">indices_to_remove</span>

<div class="viewcode-block" id="StellarOpNav.review_outliers">
<a class="viewcode-back" href="../../../stellar_opnav/stellar_class/giant.stellar_opnav.stellar_class.StellarOpNav.review_outliers.html#giant.stellar_opnav.stellar_class.StellarOpNav.review_outliers">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">review_outliers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sigma_cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">hard_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method review outliers for all images within a camera object and allows for them to be removed through a</span>
<span class="sd">        simple gui.</span>

<span class="sd">        Possible outliers are identified either using :func:`.get_outliers` or through a hard threshold.  The</span>
<span class="sd">        ``sigma_cutoff`` is passed to the same argument in the :func:`.get_outliers`.  The ``hard_threshold`` is used to</span>
<span class="sd">        identify possible outliers by simply thresholding the total pixel error (sqrt(x**2+y**2)).  All possible</span>
<span class="sd">        outliers from either method are shown to the user for possible manual removal using the :func:`.show_outlier`</span>
<span class="sd">        function.</span>

<span class="sd">        For automated outlier removal see the :meth:`remove_outliers` method.</span>

<span class="sd">        :param sigma_cutoff: the sigma threshold to use in the Median Absolute Deviation check</span>
<span class="sd">        :param hard_threshold: The hard threshold to use in units of pixels</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">image_num</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="p">:</span>
            <span class="n">indices_to_remove</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_review_image_outliers</span><span class="p">(</span><span class="n">image_num</span><span class="p">,</span> <span class="n">sigma_cutoff</span><span class="p">,</span> <span class="n">hard_threshold</span><span class="p">)</span>
            <span class="c1"># Remove any stars that were identified for removal in outlier_check</span>
            <span class="k">if</span> <span class="n">indices_to_remove</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_matched_stars</span><span class="p">(</span><span class="n">image_num</span><span class="p">,</span> <span class="n">indices_to_remove</span><span class="p">)</span></div>


<div class="viewcode-block" id="StellarOpNav.remove_outliers">
<a class="viewcode-back" href="../../../stellar_opnav/stellar_class/giant.stellar_opnav.stellar_class.StellarOpNav.remove_outliers.html#giant.stellar_opnav.stellar_class.StellarOpNav.remove_outliers">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">remove_outliers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sigma_cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">hard_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method removes outliers for all images within a camera object.</span>

<span class="sd">        Outliers are identified using :func:`.get_outliers` and through a hard threshold. The</span>
<span class="sd">        ``sigma_cutoff`` is passed to the same argument in the :func:`.get_outliers`.  The ``hard_threshold`` is used to</span>
<span class="sd">        identify possible outliers by simply thresholding the total pixel error (sqrt(x**2+y**2)).  All possible</span>
<span class="sd">        outliers from either method are removed.</span>

<span class="sd">        :param sigma_cutoff: the sigma threshold to use in the Median Absolute Deviation check</span>
<span class="sd">        :param hard_threshold: The hard threshold to use in units of pixels</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">image_num</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="p">:</span>
            <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matched_star_residuals</span><span class="p">(</span><span class="n">image_num</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">residuals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">residuals</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>

                <span class="n">outliers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_outliers</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">sigma_cutoff</span><span class="p">,</span> <span class="n">hard_threshold</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">outliers</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>

                    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">outliers</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">remove_matched_stars</span><span class="p">(</span><span class="n">image_num</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span></div>


<div class="viewcode-block" id="StellarOpNav.clear_results">
<a class="viewcode-back" href="../../../stellar_opnav/stellar_class/giant.stellar_opnav.stellar_class.StellarOpNav.clear_results.html#giant.stellar_opnav.stellar_class.StellarOpNav.clear_results">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">clear_results</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This clears all results arrays and resets them to their original values.</span>

<span class="sd">        Note that you cannot retrieve data anymore once this is called unless you have saved it yourself, therefore</span>
<span class="sd">        caution is urged.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">number_images</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camera</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_image_points</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_image_illums</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_psfs</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_stats</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extracted_snrs</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">process_stars</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_star_records</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_image_points</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queried_catalog_unit_vectors</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queried_weights_inertial</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queried_weights_picture</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_star_records</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_image_points</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_catalog_unit_vectors</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_image_points</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_psfs</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_image_illums</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_weights_inertial</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_weights_picture</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_stats</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unmatched_extracted_snrs</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_star_records</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_image_points</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_inertial</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_image_points</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_inertial</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_weights_picture</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_psfs</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_image_illums</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_catalog_unit_vectors_camera</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_stats</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matched_extracted_snrs</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_images</span></div>

        
    <span class="k">def</span><span class="w"> </span><span class="nf">_reset_process_stars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">process_stars</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process_stars</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span></div>

</pre></div>

          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
<div class="footer">
    <div style="display:inline-block;vertical-align:middle;">
        <img src="/_static/NASA_logo.svg" alt="NASA" style="width:80px;height:80px;">
    </div>
    <div style="display:inline-block;vertical-align:middle;">
        &copy;2023 United States Government | 
        NASA Official: <a href="mailto:andrew.j.liounis@nasa.gov">Andrew Liounis</a> |
        Curator: <a href="mailto:andrew.j.liounis@nasa.gov">Andrew Liounis</a>
        <br>
        Last updated on Sep 03, 2025 |
        
        |
        Powered by <a href="http://sphinx-doc.org/">Sphinx 8.2.3</a>
        &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 1.0.0</a>
        
        |
        <a href="https://www.nasa.gov/about/highlights/HP_Privacy.html">Privacy Policy/Notices</a>
    </div>
</div>
  </body>
</html>