
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>surface_features &#8212; GIANT 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../_static/logo.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="copyright" title="Copyright" href="../../../copyright.html" />
    <link rel="next" title="FeatureCatalogue" href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue.html" />
    <link rel="prev" title="sfn_correlator" href="sfn_correlators/giant.relative_opnav.estimators.sfn.sfn_correlators.sfn_correlator.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../../index.html">
    <img class="logo" src="../../../_static/logo.png" alt="Logo"/>
    
  </a>
</p>



<p class="blurb">A powerful API for Optical Navigation</p>






<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installing GIANT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../giant.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../giant.html#indices">Indices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../copyright.html">Copyright</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../giant.html">API Reference</a><ul>
  <li><a href="../../../giant.relative_opnav.html">giant.relative_opnav</a><ul>
  <li><a href="../../giant.relative_opnav.estimators.html">estimators</a><ul>
  <li><a href="../giant.relative_opnav.estimators.sfn.html">sfn</a><ul>
      <li>Previous: <a href="sfn_correlators/giant.relative_opnav.estimators.sfn.sfn_correlators.sfn_correlator.html" title="previous chapter">sfn_correlator</a></li>
      <li>Next: <a href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue.html" title="next chapter">FeatureCatalogue</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="sfn_correlators/giant.relative_opnav.estimators.sfn.sfn_correlators.sfn_correlator.html" title="Previous document">sfn_correlator</a>
        </li>
        <li>
          <a href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue.html" title="Next document">FeatureCatalogue</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="module-giant.relative_opnav.estimators.sfn.surface_features">
<span id="surface-features"></span><h1>surface_features<a class="headerlink" href="#module-giant.relative_opnav.estimators.sfn.surface_features" title="Permalink to this headline">¶</a></h1>
<p>This module implements the idea of a surface feature and surface feature catalogue for GIANT.</p>
<section id="detailed-description">
<h2>Detailed Description<a class="headerlink" href="#detailed-description" title="Permalink to this headline">¶</a></h2>
<p>In GIANT, a surface feature refers to a small path of surface from a body that is treated as an individual target to
identify in an image. A feature catalogue is then a collection of these features that is used for tracking the features
together and determining which are visible/worthy to search for in a given image.  These capabilities are implemented in
the <a class="reference internal" href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature.html#giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature" title="giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature"><code class="xref py py-class docutils literal notranslate"><span class="pre">SurfaceFeature</span></code></a>, <a class="reference internal" href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue.html#giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue" title="giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeatureCatalogue</span></code></a>, and <a class="reference internal" href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.VisibleFeatureFinder.html#giant.relative_opnav.estimators.sfn.surface_features.VisibleFeatureFinder" title="giant.relative_opnav.estimators.sfn.surface_features.VisibleFeatureFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">VisibleFeatureFinder</span></code></a> respectively.</p>
<p>In more detail, a <a class="reference internal" href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature.html#giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature" title="giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature"><code class="xref py py-class docutils literal notranslate"><span class="pre">SurfaceFeature</span></code></a> in GIANT is essentially a wrapper around a DEM modeled as a traceable object
(a <a class="reference internal" href="../../../ray_tracer/kdtree/giant.ray_tracer.kdtree.KDTree.html#giant.ray_tracer.kdtree.KDTree" title="giant.ray_tracer.kdtree.KDTree"><code class="xref py py-class docutils literal notranslate"><span class="pre">KDTree</span></code></a> or <a class="reference internal" href="../../../ray_tracer/shapes/shape/giant.ray_tracer.shapes.shape.Shape.html#giant.ray_tracer.shapes.shape.Shape" title="giant.ray_tracer.shapes.shape.Shape"><code class="xref py py-class docutils literal notranslate"><span class="pre">Shape</span></code></a>) that also contains some basic information about the DEM, including the normal
vector of the best fit plane through the DEM data, the center of the DEM, and the average ground sample distance of the
DEM.  Additionally, the <a class="reference internal" href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature.html#giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature" title="giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature"><code class="xref py py-class docutils literal notranslate"><span class="pre">SurfaceFeature</span></code></a> class provides functionality for storing the DEM information itself on
disk until it is needed as well as managing at which point it can be unloaded from memory, which can be important for
long running processes.</p>
<p>The <a class="reference internal" href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue.html#giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue" title="giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeatureCatalogue</span></code></a> then stores a list of these features, as well as some numpy arrays which combine all of
the normal vectors, bounding box vertices, and locations into single contiguous arrays for computational efficiency.
These numpy arrays also get rotated/translated whenever the feature catalogue gets rotated/translated, which means that
they are always in the current frame (which normally ends up being the camera frame). Additionally, this class provides
an option for filtering the features that are included when a call to the <code class="docutils literal notranslate"><span class="pre">trace</span></code> method is made.</p>
<p>Finally, the <a class="reference internal" href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.VisibleFeatureFinder.html#giant.relative_opnav.estimators.sfn.surface_features.VisibleFeatureFinder" title="giant.relative_opnav.estimators.sfn.surface_features.VisibleFeatureFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">VisibleFeatureFinder</span></code></a> operates on a feature catalogue to identify which features are visible in an
image based on the current knowledge of the scene at the time of the image.  This filtering considers things like the
incidence and reflection angles, the ratio of the camera ground sample distance to the feature ground sample distance,
and the percentage of the feature predicted to actually be within the field of view of the camera.</p>
<p>For more in-depth details on each of these classes we encourage you to consider their documentation.</p>
</section>
<section id="lazy-loading-unloading">
<h2>Lazy Loading/Unloading<a class="headerlink" href="#lazy-loading-unloading" title="Permalink to this headline">¶</a></h2>
<p>One of the key things about surface features are that they are usually pretty high resolution patches of surface (that
is patches of surface with small ground sample distances).  We can get away with these small ground sample distances
because the surface area each feature covers is also small, which means the size of any given feature is small.  Despite
this, we frequently have enough patches to globally cover the surface of the body we are imaging, and many times have
features that overlap each other so we actually have enough features to cover the surface 2-3 times over.  Beyond that,
we also typically have global coverage of the surface with features at varying ground sample distances.  All of this
combines to mean that feature catalogues are typically huge, particularly when compared with a typical global model for
a body.  In many cases, because of this size, it is infeasible or even impossible to store the entire feature catalogue
in memory at once, even on modern systems.</p>
<p>To overcome this issue, we have implemented a lazy loading/unloading scheme for feature catalogues and surface features
in GIANT.  The way this scheme works is when we create a <a class="reference internal" href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature.html#giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature" title="giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature"><code class="xref py py-class docutils literal notranslate"><span class="pre">SurfaceFeature</span></code></a>, instead of providing the DEM data
that represents the feature, we instead provide an absolute file path to a pickle file which contains just the DEM data
for the feature.  When doing this, the size of each <a class="reference internal" href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature.html#giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature" title="giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature"><code class="xref py py-class docutils literal notranslate"><span class="pre">SurfaceFeature</span></code></a> object in the <a class="reference internal" href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue.html#giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue" title="giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeatureCatalogue</span></code></a> is
very small.  Then, when we actually need the DEM data for the feature, we load it into memory from the referenced file.
This dramatically decreases the memory footprint of our process, making it feasible to operate through a whole feature
catalogue without using hundreds of GB of memory.</p>
<p>Now, this lazy loading is great at the start, but if we have a long running process that keeps using more and more
features we will eventually end up loading the entire feature catalogue into memory anyway, which would ultimately
defeat the purpose of the lazy loading.  Therefore, we also provide an unloading mechanism, where the “time” since the
feature was last used (time here being the number of images since we last used the feature) is used to determine if we
should remove the feature from memory.  Additionally, we provide a check one the percentage of the total system memory
that the process is using and if we are over a certain percentage, we start unloading features regardless of when they
were last used.</p>
<p>The combination of the loading and unloading makes surface feature navigation possible in GIANT even on systems with
modest amounts of memory available to the system.  If you are working on a system with huge amounts of memory, you can
bypass these features, but for most people, even with large amounts of memory, we encourage leaving them on.  For more
details on how you can tune each of these capabilities, refer to the <a class="reference internal" href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue.html#giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue" title="giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeatureCatalogue</span></code></a> and
<a class="reference internal" href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature.html#giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature" title="giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature"><code class="xref py py-class docutils literal notranslate"><span class="pre">SurfaceFeature</span></code></a> documentation.</p>
<p>One thing to note about using an absolute path to the file containing the DEM information for each feature is that it
makes feature catalogues brittle.  That is, unless the directory structure between 2 systems is the same, you cannot
directly transfer a feature catalogue built on one system to another.  To help with doing this, we provide the methods
<a class="reference internal" href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue.update_feature_paths.html#giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue.update_feature_paths" title="giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue.update_feature_paths"><code class="xref py py-meth docutils literal notranslate"><span class="pre">FeatureCatalogue.update_feature_paths()</span></code></a> and <a class="reference internal" href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature.update_path.html#giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature.update_path" title="giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature.update_path"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SurfaceFeature.update_path()</span></code></a> which can be used to specify a
a new path for the files containing the surface feature DEMs.</p>
</section>
<section id="use">
<h2>Use<a class="headerlink" href="#use" title="Permalink to this headline">¶</a></h2>
<p>Generally a user will have minimal direct interaction with the classes in this module, as all of the interaction is
handled either by the <a class="reference internal" href="sfn_class/giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.html#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation"><code class="xref py py-class docutils literal notranslate"><span class="pre">SurfaceFeatureNavigation</span></code></a> class for doing navigation or the
<a class="reference internal" href="../../../scripts/giant.scripts.spc_to_feature_catalogue.html#module-giant.scripts.spc_to_feature_catalogue" title="giant.scripts.spc_to_feature_catalogue"><code class="xref py py-mod docutils literal notranslate"><span class="pre">spc_to_feature_catalogue</span></code></a> and <a class="reference internal" href="../../../scripts/giant.scripts.tile_shape.html#module-giant.scripts.tile_shape" title="giant.scripts.tile_shape"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tile_shape</span></code></a> scripts for importing/building a feature catalogue.  If you do
need to interact directly with the classes in this documentation we encourage you to consult the class documentation
directly and to look at the use of these classes in the mentioned class/scripts for examples/insight.</p>
</section>
<p class="rubric">Classes</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue.html#giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue" title="giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FeatureCatalogue</span></code></a></p></td>
<td><p>This class represents a collection of <code class="xref py py-class docutils literal notranslate"><span class="pre">SurfaceFeatures</span></code> for use in GIANT relative OpNav.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature.html#giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature" title="giant.relative_opnav.estimators.sfn.surface_features.SurfaceFeature"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SurfaceFeature</span></code></a></p></td>
<td><p>This class represents a surface feature in GIANT.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.VisibleFeatureFinder.html#giant.relative_opnav.estimators.sfn.surface_features.VisibleFeatureFinder" title="giant.relative_opnav.estimators.sfn.surface_features.VisibleFeatureFinder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">VisibleFeatureFinder</span></code></a></p></td>
<td><p>This class creates a callable which is used to filter features that are visible in an image.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.VisibleFeatureFinderOptions.html#giant.relative_opnav.estimators.sfn.surface_features.VisibleFeatureFinderOptions" title="giant.relative_opnav.estimators.sfn.surface_features.VisibleFeatureFinderOptions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">VisibleFeatureFinderOptions</span></code></a></p></td>
<td><p>This dataclass serves as one way to control the settings for the <a class="reference internal" href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.VisibleFeatureFinder.html#giant.relative_opnav.estimators.sfn.surface_features.VisibleFeatureFinder" title="giant.relative_opnav.estimators.sfn.surface_features.VisibleFeatureFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">VisibleFeatureFinder</span></code></a> at initialization.</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="sfn_correlators/giant.relative_opnav.estimators.sfn.sfn_correlators.sfn_correlator.html" title="Previous document">sfn_correlator</a>
        </li>
        <li>
          <a href="surface_features/giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalogue.html" title="Next document">FeatureCatalogue</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2021 United States Government.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../../_sources/relative_opnav/estimators/sfn/giant.relative_opnav.estimators.sfn.surface_features.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>