<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>SurfaceFeatureNavigation.estimate &#8212; GIANT 2.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/basic.css?v=3f530b75" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/alabaster.css?v=aae3c237" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=4ae1632d" />
    <script src="../../../../_static/documentation_options.js?v=51b770b3"></script>
    <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="../../../../_static/logo.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="copyright" title="Copyright" href="../../../../copyright.html" />
    <link rel="next" title="SurfaceFeatureNavigation.pnp_solver" href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.pnp_solver.html" />
    <link rel="prev" title="SurfaceFeatureNavigation.compute_rays" href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.compute_rays.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../../../index.html">
    <img class="logo" src="../../../../_static/logo.png" alt="Logo" />
    
  </a>
</p>



<p class="blurb">A powerful API for Optical Navigation</p>






<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Installing GIANT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../giant.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../giant.html#indices">Indices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../copyright.html">Copyright</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../../giant.html">API Reference</a><ul>
  <li><a href="../../../../giant.relative_opnav.html">giant.relative_opnav</a><ul>
  <li><a href="../../../giant.relative_opnav.estimators.html">estimators</a><ul>
  <li><a href="../../giant.relative_opnav.estimators.sfn.html">sfn</a><ul>
  <li><a href="../giant.relative_opnav.estimators.sfn.sfn_class.html">sfn_class</a><ul>
  <li><a href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.html">SurfaceFeatureNavigation</a><ul>
      <li>Previous: <a href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.compute_rays.html" title="previous chapter">SurfaceFeatureNavigation.compute_rays</a></li>
      <li>Next: <a href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.pnp_solver.html" title="next chapter">SurfaceFeatureNavigation.pnp_solver</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.compute_rays.html" title="Previous document">SurfaceFeatureNavigation.compute_rays</a>
        </li>
        <li>
          <a href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.pnp_solver.html" title="Next document">SurfaceFeatureNavigation.pnp_solver</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="surfacefeaturenavigation-estimate">
<h1>SurfaceFeatureNavigation.estimate<a class="headerlink" href="#surfacefeaturenavigation-estimate" title="Link to this heading">¶</a></h1>
<p><a class="reference internal" href="../giant.relative_opnav.estimators.sfn.sfn_class.html#module-giant.relative_opnav.estimators.sfn.sfn_class" title="giant.relative_opnav.estimators.sfn.sfn_class"><code class="xref py py-mod docutils literal notranslate"><span class="pre">giant.relative_opnav.estimators.sfn.sfn_class</span></code></a>:</p>
<dl class="py method">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.estimate">
<span class="sig-prename descclassname"><span class="pre">SurfaceFeatureNavigation.</span></span><span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_targets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/giant/relative_opnav/estimators/sfn/sfn_class.html#SurfaceFeatureNavigation.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.estimate" title="Link to this definition">¶</a></dt>
<dd><p>This method identifies the locations of surface features in the image through cross correlation of rendered
templates with the image.</p>
<p>This method first checks to ensure that the appropriate correlator is set for the <code class="xref py py-attr docutils literal notranslate"><span class="pre">image_processing</span></code>
instance (which should the <a class="reference internal" href="../sfn_correlators/giant.relative_opnav.estimators.sfn.sfn_correlators.sfn_correlator.html#giant.relative_opnav.estimators.sfn.sfn_correlators.sfn_correlator" title="giant.relative_opnav.estimators.sfn.sfn_correlators.sfn_correlator"><code class="xref py py-func docutils literal notranslate"><span class="pre">sfn_correlator()</span></code></a>).  If it is not a warning is printed and we set the
correlator to be the <a class="reference internal" href="../sfn_correlators/giant.relative_opnav.estimators.sfn.sfn_correlators.sfn_correlator.html#giant.relative_opnav.estimators.sfn.sfn_correlators.sfn_correlator" title="giant.relative_opnav.estimators.sfn.sfn_correlators.sfn_correlator"><code class="xref py py-func docutils literal notranslate"><span class="pre">sfn_correlator()</span></code></a> (this is required for surface feature navigation).  Don’t worry,
we’ll put things back the way they were when we’re done :).</p>
<p>This method also identifies the index into the <a class="reference internal" href="../../../../camera/giant.camera.Camera.html#giant.camera.Camera.images" title="giant.camera.Camera.images"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Camera.images</span></code></a> list for the image being processed. This
is done by first checking identity (to find the exact same image). If that doesn’t work we then check based on
equality (the pixel data is all exactly the same) however, this could lead to false pairing in some degenerate
instances.  As long as you are using this method as intended (and not copying/modifying the image array from the
camera before sending it to this method) the identity check should work.  We do this so that we can relocate
each target to be along the line of sight vector found by center finding (if done/provided) before looking for
features.  Therefore if you aren’t seeding your SFN with center finding results you don’t need to worry about
this.</p>
<p>Once the initial preparation is complete, for each requested target that is a <a class="reference internal" href="../surface_features/giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalog.html#giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalog" title="giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalog"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeatureCatalog</span></code></a> we seek
feature locations that are visible in the image. This is done by first predicting which features from the
catalog should be visible in the image using the a priori relative state knowledge between the camera and the
feature catalog and the <a class="reference internal" href="../surface_features/giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalog.html#giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalog.feature_finder" title="giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalog.feature_finder"><code class="xref py py-attr docutils literal notranslate"><span class="pre">FeatureCatalog.feature_finder</span></code></a> function which is usually an instance of
<a class="reference internal" href="../surface_features/giant.relative_opnav.estimators.sfn.surface_features.VisibleFeatureFinder.html#giant.relative_opnav.estimators.sfn.surface_features.VisibleFeatureFinder" title="giant.relative_opnav.estimators.sfn.surface_features.VisibleFeatureFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">VisibleFeatureFinder</span></code></a>.  Once potentially visible features have been determined, we render a predicted
template of each feature using a single bounce ray tracer.  We then do spatial cross correlation between the
template and the image within a specified search region (if the search region is too large we attempt global
frequency correlation first) to generate a correlation surface.  From this correlation surface, we identify the
peak and use that to locate the center of the feature in the image.  Once this has been completed for all
potentially visible features for a given target, we then optionally attempt to solve a PnP problem to refine the
relative position and orientation of the camera with respect to the target based on the observed feature
locations.  If we successfully solve the PnP problem, then we iterate 1 more time through the entire process
(but not the PnP solver) and the results from that time become the observed locations stored in the
<a class="reference internal" href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.html#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.observed_bearings" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.observed_bearings"><code class="xref py py-attr docutils literal notranslate"><span class="pre">observed_bearings</span></code></a> attribute.</p>
<p>More details about many of these steps can be seen in the <a class="reference internal" href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.render.html#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.render" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.render"><code class="xref py py-meth docutils literal notranslate"><span class="pre">render()</span></code></a> and <a class="reference internal" href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.pnp_solver.html#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.pnp_solver" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.pnp_solver"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pnp_solver()</span></code></a> methods.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Before calling this method be sure that the scene has been updated to correspond to the correct
image time.  This method does not update the scene automatically.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<a class="reference internal" href="../../../../image/giant.image.OpNavImage.html#giant.image.OpNavImage" title="giant.image.OpNavImage"><em>OpNavImage</em></a>) – The image to locate the targets in</p></li>
<li><p><strong>include_targets</strong> (<em>List</em><em>[</em><em>bool</em><em>] </em><em>| </em><em>None</em>) – A list specifying whether to process the corresponding target in
<a class="reference internal" href="../../../../ray_tracer/scene/giant.ray_tracer.scene.Scene.html#giant.ray_tracer.scene.Scene.target_objs" title="giant.ray_tracer.scene.Scene.target_objs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Scene.target_objs</span></code></a> or <code class="docutils literal notranslate"><span class="pre">None</span></code>.  If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all targets are processed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.compute_rays.html" title="Previous document">SurfaceFeatureNavigation.compute_rays</a>
        </li>
        <li>
          <a href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.pnp_solver.html" title="Next document">SurfaceFeatureNavigation.pnp_solver</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
<div class="footer">
    <div style="display:inline-block;vertical-align:middle;">
        <img src="/_static/NASA_logo.svg" alt="NASA" style="width:80px;height:80px;">
    </div>
    <div style="display:inline-block;vertical-align:middle;">
        &copy;2023 United States Government | 
        NASA Official: <a href="mailto:andrew.j.liounis@nasa.gov">Andrew Liounis</a> |
        Curator: <a href="mailto:andrew.j.liounis@nasa.gov">Andrew Liounis</a>
        <br>
        Last updated on Sep 03, 2025 |
        
        |
        Powered by <a href="http://sphinx-doc.org/">Sphinx 8.2.3</a>
        &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 1.0.0</a>
        
        |
        <a href="https://www.nasa.gov/about/highlights/HP_Privacy.html">Privacy Policy/Notices</a>
    </div>
</div>
  </body>
</html>