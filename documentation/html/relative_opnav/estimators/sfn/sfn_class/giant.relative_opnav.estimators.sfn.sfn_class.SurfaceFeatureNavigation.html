<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>SurfaceFeatureNavigation &#8212; GIANT 2.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/basic.css?v=3f530b75" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/alabaster.css?v=aae3c237" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=4ae1632d" />
    <script src="../../../../_static/documentation_options.js?v=51b770b3"></script>
    <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="icon" href="../../../../_static/logo.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="copyright" title="Copyright" href="../../../../copyright.html" />
    <link rel="next" title="SurfaceFeatureNavigation.apply_options" href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.apply_options.html" />
    <link rel="prev" title="sfn_class" href="../giant.relative_opnav.estimators.sfn.sfn_class.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../../../index.html">
    <img class="logo" src="../../../../_static/logo.png" alt="Logo" />
    
  </a>
</p>



<p class="blurb">A powerful API for Optical Navigation</p>






<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Installing GIANT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../giant.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../giant.html#indices">Indices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../copyright.html">Copyright</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../../giant.html">API Reference</a><ul>
  <li><a href="../../../../giant.relative_opnav.html">giant.relative_opnav</a><ul>
  <li><a href="../../../giant.relative_opnav.estimators.html">estimators</a><ul>
  <li><a href="../../giant.relative_opnav.estimators.sfn.html">sfn</a><ul>
  <li><a href="../giant.relative_opnav.estimators.sfn.sfn_class.html">sfn_class</a><ul>
      <li>Previous: <a href="../giant.relative_opnav.estimators.sfn.sfn_class.html" title="previous chapter">sfn_class</a></li>
      <li>Next: <a href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.apply_options.html" title="next chapter">SurfaceFeatureNavigation.apply_options</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="../giant.relative_opnav.estimators.sfn.sfn_class.html" title="Previous document">sfn_class</a>
        </li>
        <li>
          <a href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.apply_options.html" title="Next document">SurfaceFeatureNavigation.apply_options</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="surfacefeaturenavigation">
<h1>SurfaceFeatureNavigation<a class="headerlink" href="#surfacefeaturenavigation" title="Link to this heading">¶</a></h1>
<p><a class="reference internal" href="../giant.relative_opnav.estimators.sfn.sfn_class.html#module-giant.relative_opnav.estimators.sfn.sfn_class" title="giant.relative_opnav.estimators.sfn.sfn_class"><code class="xref py py-mod docutils literal notranslate"><span class="pre">giant.relative_opnav.estimators.sfn.sfn_class</span></code></a>:</p>
<dl class="py class">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">giant.relative_opnav.estimators.sfn.sfn_class.</span></span><span class="sig-name descname"><span class="pre">SurfaceFeatureNavigation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">camera</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/giant/relative_opnav/estimators/sfn/sfn_class.html#SurfaceFeatureNavigation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation" title="Link to this definition">¶</a></dt>
<dd><p>This class implements surface feature navigation using normalized cross correlation template matching for GIANT.</p>
<p>All of the steps required for performing surface feature navigation are handled by this class, including the
identification of visible features in the image, the rendering of the templates for each feature, the actual cross
correlation, the identification of the peaks of the correlation surfaces, and optionally the solution of a PnP
problem based on the observed feature locations in the image.  This is all handled in the <a class="reference internal" href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.estimate.html#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.estimate" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.estimate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">estimate()</span></code></a> method
and is performed for each requested target.  Note that targets must have shapes of <a class="reference internal" href="../surface_features/giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalog.html#giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalog" title="giant.relative_opnav.estimators.sfn.surface_features.FeatureCatalog"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeatureCatalog</span></code></a> to use
this class.</p>
<p>When all of the required data has been successfully loaded into an instance of this class, the <a class="reference internal" href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.estimate.html#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.estimate" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.estimate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">estimate()</span></code></a>
method is used to perform the estimation for the requested image.  The results are stored into the
<a class="reference internal" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.observed_bearings" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.observed_bearings"><code class="xref py py-attr docutils literal notranslate"><span class="pre">observed_bearings</span></code></a> attribute for the observed center of template locations. In addition, the predicted
locations for the center of template for each template is stored in the <a class="reference internal" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.computed_bearings" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.computed_bearings"><code class="xref py py-attr docutils literal notranslate"><span class="pre">computed_bearings</span></code></a> attribute.
Finally, the details about the fit are stored as a dictionary in the appropriate element in the <a class="reference internal" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.details" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.details"><code class="xref py py-attr docutils literal notranslate"><span class="pre">details</span></code></a>
attribute.  Specifically, these dictionaries will contain the following keys.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'Correlation</span> <span class="pre">Scores'</span></code></p></td>
<td><p>The correlation score at the peak of the correlation surface for each feature as a
list of floats. The corresponding element will be 0 for any features that were not
found.  Each element of this list corresponds to the feature according to the
corresponding element in the <code class="docutils literal notranslate"><span class="pre">'Visible</span> <span class="pre">Features'</span></code> list. If no potential visible
features were expected in the image then this is not available.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'Visible</span> <span class="pre">Features'</span></code></p></td>
<td><p>The list of feature indices (into the <code class="xref py py-attr docutils literal notranslate"><span class="pre">FeatureCatalog.features</span></code> list)
that were looked for in the image.  Each element of this list corresponds to the
corresponding element in the <a class="reference internal" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.templates" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.templates"><code class="xref py py-attr docutils literal notranslate"><span class="pre">templates</span></code></a> list.  If no potential visible
features were expected in the image then this is not available.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'Correlation</span> <span class="pre">Peak</span> <span class="pre">Locations'</span></code></p></td>
<td><p>The Location of the correlation peaks before correcting it to find the location of
the location of the feature in the image as a list of size 2 numpy arrays. Each
element of this list corresponds to the feature according to the corresponding
element in the <code class="docutils literal notranslate"><span class="pre">'Visible</span> <span class="pre">Features'</span></code> list.  Any features that were not found in
the image have <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> for their values.  If no potential visible features were
expected in the image then this is not available.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'Correlation</span> <span class="pre">Surfaces'</span></code></p></td>
<td><p>The raw correlation surfaces as 2D arrays of shape
<code class="docutils literal notranslate"><span class="pre">2*search_region+1</span> <span class="pre">x</span> <span class="pre">2*search_region+1</span></code>.  Each pixel in the correlation surface
represents a shift between the predicted and expected location, according to
<a class="reference internal" href="../sfn_correlators/giant.relative_opnav.estimators.sfn.sfn_correlators.sfn_correlator.html#giant.relative_opnav.estimators.sfn.sfn_correlators.sfn_correlator" title="giant.relative_opnav.estimators.sfn.sfn_correlators.sfn_correlator"><code class="xref py py-func docutils literal notranslate"><span class="pre">sfn_correlator()</span></code></a>.  Each element of this list corresponds to the feature
according to the corresponding element in the <code class="docutils literal notranslate"><span class="pre">'Visible</span> <span class="pre">Features'</span></code> list.  If no
potential visible features were expected in the image then this is not available.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'Target</span> <span class="pre">Template</span> <span class="pre">Coordinates'</span></code></p></td>
<td><p>The location of the center of each feature in its corresponding template. Each
element of this list corresponds to the feature according to the corresponding
element in the <code class="docutils literal notranslate"><span class="pre">'Visible</span> <span class="pre">Features'</span></code> list.  If no potential visible features
were expected in the image then this is not available.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'Intersect</span> <span class="pre">Masks'</span></code></p></td>
<td><p>The boolean arrays the shape shapes of each rendered template with <code class="docutils literal notranslate"><span class="pre">True</span></code> where
a ray through that pixel struct the surface of the template and <code class="docutils literal notranslate"><span class="pre">False</span></code>
otherwise. Each element of this list corresponds to the feature according to the
corresponding element in the <code class="docutils literal notranslate"><span class="pre">'Visible</span> <span class="pre">Features'</span></code> list.  If no potential
visible features were expected in the image then this is not available.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'Space</span> <span class="pre">Mask'</span></code></p></td>
<td><p>The boolean array the same shape as the image specifying which pixels of the image
we thought were empty space with a <code class="docutils literal notranslate"><span class="pre">True</span></code> and which we though were on the body
with a <code class="docutils literal notranslate"><span class="pre">False</span></code>.  If no potential visible features were expected in the image
then this is not available</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'PnP</span> <span class="pre">Solution'</span></code></p></td>
<td><p>A boolean indicating whether the PnP solution was successful (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or not.
This is only available if a PnP solution was attempted.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'PnP</span> <span class="pre">Translation'</span></code></p></td>
<td><p>The solved for translation in the original camera frame that minimizes the
residuals in the PnP solution as a length 3 array with units of kilometers.  This
is only available if a PnP solution was attempted and the PnP solution was
successful.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'PnP</span> <span class="pre">Rotation'</span></code></p></td>
<td><p>The solved for rotation of the original camera frame that minimizes the
residuals in the PnP solution as a <a class="reference internal" href="../../../../rotations/rotation/giant.rotations.rotation.Rotation.html#giant.rotations.rotation.Rotation" title="giant.rotations.rotation.Rotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Rotation</span></code></a>.  This
is only available if a PnP solution was attempted and the PnP solution was
successful.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'PnP</span> <span class="pre">Position'</span></code></p></td>
<td><p>The solved for relative position of the target in the camera frame after the PnP
solution is applied as a length 3 numpy array in km.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'PnP</span> <span class="pre">Orientation'</span></code></p></td>
<td><p>The solved for relative orientation of the target frame with respect to the camera
frame after the PnP solution is applied as a <a class="reference internal" href="../../../../rotations/rotation/giant.rotations.rotation.Rotation.html#giant.rotations.rotation.Rotation" title="giant.rotations.rotation.Rotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Rotation</span></code></a>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'Failed'</span></code></p></td>
<td><p>A message indicating why the SFN failed.  This will only be present if the SFN fit
failed (so you could do something like <code class="docutils literal notranslate"><span class="pre">'Failed'</span> <span class="pre">in</span> <span class="pre">sfn.details[target_ind]</span></code> to
check if something failed.  The message should be a human readable description of
what caused the failure.</p></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Before calling the <a class="reference internal" href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.estimate.html#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.estimate" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.estimate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">estimate()</span></code></a> method be sure that the scene has been updated to correspond to the correct
image time.  This class does not update the scene automatically.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scene</strong> (<a class="reference internal" href="../../../../ray_tracer/scene/giant.ray_tracer.scene.Scene.html#giant.ray_tracer.scene.Scene" title="giant.ray_tracer.scene.Scene"><em>Scene</em></a>) – The scene describing the a priori locations of the targets and the light source.</p></li>
<li><p><strong>camera</strong> (<a class="reference internal" href="../../../../camera/giant.camera.Camera.html#giant.camera.Camera" title="giant.camera.Camera"><em>Camera</em></a>) – The <a class="reference internal" href="../../../../camera/giant.camera.Camera.html#giant.camera.Camera" title="giant.camera.Camera"><code class="xref py py-class docutils literal notranslate"><span class="pre">Camera</span></code></a> object containing the camera model and images to be analyzed</p></li>
<li><p><strong>options</strong> (<a class="reference internal" href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigationOptions.html#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigationOptions" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigationOptions"><em>SurfaceFeatureNavigationOptions</em></a><em> | </em><em>None</em>) – A dataclass specifying the options to set for this instance.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.camera">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">camera</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../../../../camera/giant.camera.Camera.html#giant.camera.Camera" title="giant.camera.Camera"><span class="pre">Camera</span></a></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.camera" title="Link to this definition">¶</a></dt>
<dd><p>The camera instance that represents the camera used to take the images we are performing Relative OpNav on.</p>
<p>This is the source of the camera model, and may be used for other information about the camera as well.
See the <a class="reference internal" href="../../../../camera/giant.camera.Camera.html#giant.camera.Camera" title="giant.camera.Camera"><code class="xref py py-class docutils literal notranslate"><span class="pre">Camera</span></code></a> property for details.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.relnav_handler">
<span class="sig-name descname"><span class="pre">relnav_handler</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.relnav_handler" title="Link to this definition">¶</a></dt>
<dd><p>A custom handler for doing estimation/packaging the results into the <a class="reference internal" href="../../../relnav_class/giant.relative_opnav.relnav_class.RelativeOpNav.html#giant.relative_opnav.relnav_class.RelativeOpNav" title="giant.relative_opnav.relnav_class.RelativeOpNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">RelativeOpNav</span></code></a> instance.</p>
<p>Typically this should be <code class="docutils literal notranslate"><span class="pre">None</span></code>, unless the <a class="reference internal" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.observable_type" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.observable_type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">observable_type</span></code></a> is set to 
<a class="reference internal" href="../../estimator_interface_abc/giant.relative_opnav.estimators.estimator_interface_abc.RelNavObservablesType.html#giant.relative_opnav.estimators.estimator_interface_abc.RelNavObservablesType.CUSTOM" title="giant.relative_opnav.estimators.estimator_interface_abc.RelNavObservablesType.CUSTOM"><code class="xref py py-attr docutils literal notranslate"><span class="pre">RelNavObservablesType.CUSTOM</span></code></a>, in which case this must be a function where the first and only positional 
argument is the <a class="reference internal" href="../../../relnav_class/giant.relative_opnav.relnav_class.RelativeOpNav.html#giant.relative_opnav.relnav_class.RelativeOpNav" title="giant.relative_opnav.relnav_class.RelativeOpNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">RelativeOpNav</span></code></a> instance that this technique was registered to and there are 2 key word 
arguments <code class="docutils literal notranslate"><span class="pre">image_ind</span></code> and <code class="docutils literal notranslate"><span class="pre">include_targets</span></code> which should be used to control which image/target is processed.</p>
<p>If <a class="reference internal" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.observable_type" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.observable_type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">observable_type</span></code></a> is not <a class="reference internal" href="../../estimator_interface_abc/giant.relative_opnav.estimators.estimator_interface_abc.RelNavObservablesType.html#giant.relative_opnav.estimators.estimator_interface_abc.RelNavObservablesType.CUSTOM" title="giant.relative_opnav.estimators.estimator_interface_abc.RelNavObservablesType.CUSTOM"><code class="xref py py-attr docutils literal notranslate"><span class="pre">RelNavObservablesType.CUSTOM</span></code></a> then this is ignored whether it is <code class="docutils literal notranslate"><span class="pre">None</span></code> 
or not.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.scene">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">scene</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../../../../ray_tracer/scene/giant.ray_tracer.scene.Scene.html#giant.ray_tracer.scene.Scene" title="giant.ray_tracer.scene.Scene"><span class="pre">Scene</span></a></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.scene" title="Link to this definition">¶</a></dt>
<dd><p>The scene which defines the a priori locations of all targets and light sources with respect to the camera.</p>
<p>You can assume that the scene has been updated for the appropriate image time inside of the class.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.details">
<span class="sig-name descname"><span class="pre">details</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.details" title="Link to this definition">¶</a></dt>
<dd><p>This attribute should provide details from applying the technique to each target in the scene.</p>
<p>The list should be the same length at the <a class="reference internal" href="../../../../ray_tracer/scene/giant.ray_tracer.scene.Scene.html#giant.ray_tracer.scene.Scene.target_objs" title="giant.ray_tracer.scene.Scene.target_objs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Scene.target_objs</span></code></a>.  Typically, if the technique was not 
applied for some of the targets then the details for the corresponding element should be <code class="docutils literal notranslate"><span class="pre">None</span></code>.  Beyond each
element of the details should typically contain a dictionary providing information about the results that is not
strictly needed for understanding what happened, however, this is not required and you can use whatever 
structure you want to convey the information.  Whatever you do, however, you should clearly document it for each
technique so that the user can know what to expect.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.observed_bearings">
<span class="sig-name descname"><span class="pre">observed_bearings</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">NONEARRAY</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.observed_bearings" title="Link to this definition">¶</a></dt>
<dd><p>A list of the observed bearings in the image where each element corresponds to
the same element in the <a class="reference internal" href="../../../../ray_tracer/scene/giant.ray_tracer.scene.Scene.html#giant.ray_tracer.scene.Scene.target_objs" title="giant.ray_tracer.scene.Scene.target_objs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Scene.target_objs</span></code></a> list.</p>
<p>The list elements should be numpy arrays or <code class="docutils literal notranslate"><span class="pre">None</span></code> if the the target wasn’t considered for some reason.  If
numpy arrays they should contain the pixel locations as (x, y) or (col, row).  This does not always need to be 
filled out.</p>
<p>This is were you should store results for <code class="docutils literal notranslate"><span class="pre">CENTER-FINDING,</span> <span class="pre">LIMB,</span> <span class="pre">LANDMARK,</span> <span class="pre">CONSTRAINT</span></code> techniques.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.computed_bearings">
<span class="sig-name descname"><span class="pre">computed_bearings</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">NONEARRAY</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.computed_bearings" title="Link to this definition">¶</a></dt>
<dd><p>A list of the computed (predicted) bearings in the image where each element corresponds to
the same element in the <a class="reference internal" href="../../../../ray_tracer/scene/giant.ray_tracer.scene.Scene.html#giant.ray_tracer.scene.Scene.target_objs" title="giant.ray_tracer.scene.Scene.target_objs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Scene.target_objs</span></code></a> list.</p>
<p>The list elements should be numpy arrays or <code class="docutils literal notranslate"><span class="pre">None</span></code> if the the target wasn’t considered for some reason.  If
numpy arrays they should contain the pixel locations as (x, y) or (col, row).  This does not always need to be 
filled out.</p>
<p>This is were you should store results for <code class="docutils literal notranslate"><span class="pre">CENTER-FINDING,</span> <span class="pre">LIMB,</span> <span class="pre">LANDMARK,</span> <span class="pre">CONSTRAINT</span></code> techniques.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.templates">
<span class="sig-name descname"><span class="pre">templates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DOUBLE_ARRAY</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DOUBLE_ARRAY</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.templates" title="Link to this definition">¶</a></dt>
<dd><p>A list of rendered templates generated by this technique.</p>
<p>The list elements should be numpy arrays or <code class="docutils literal notranslate"><span class="pre">None</span></code> if the the target wasn’t considered or this type of
measurement is not applicable.  If numpy arrays they should contain the templates rendered for the target as 2D 
arrays.</p>
<p>If <a class="reference internal" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.generates_templates" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.generates_templates"><code class="xref py py-attr docutils literal notranslate"><span class="pre">generates_templates</span></code></a> is <code class="docutils literal notranslate"><span class="pre">False</span></code> this can be ignored.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.brdf">
<span class="sig-name descname"><span class="pre">brdf</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../../../../ray_tracer/illumination/giant.ray_tracer.illumination.IlluminationModel.html#giant.ray_tracer.illumination.IlluminationModel" title="giant.ray_tracer.illumination.IlluminationModel"><span class="pre">IlluminationModel</span></a></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.brdf" title="Link to this definition">¶</a></dt>
<dd><p>The illumination model that transforms the geometric ray tracing results (see <code class="xref py py-const docutils literal notranslate"><span class="pre">ILLUM_DTYPE</span></code>) into an
intensity values. Typically this is one of the options from the <a class="reference internal" href="../../../../ray_tracer/giant.ray_tracer.illumination.html#module-giant.ray_tracer.illumination" title="giant.ray_tracer.illumination"><code class="xref py py-mod docutils literal notranslate"><span class="pre">illumination</span></code></a> module).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.rays">
<span class="sig-name descname"><span class="pre">rays</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../../../../ray_tracer/rays/giant.ray_tracer.rays.Rays.html#giant.ray_tracer.rays.Rays" title="giant.ray_tracer.rays.Rays"><span class="pre">Rays</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../../../ray_tracer/rays/giant.ray_tracer.rays.Rays.html#giant.ray_tracer.rays.Rays" title="giant.ray_tracer.rays.Rays"><span class="pre">Rays</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.rays" title="Link to this definition">¶</a></dt>
<dd><p>The rays to use when rendering the template.  If <code class="docutils literal notranslate"><span class="pre">None</span></code> then the rays required to render the template will be 
automatically computed.  Optionally, a list of <a class="reference internal" href="../../../../ray_tracer/rays/giant.ray_tracer.rays.Rays.html#giant.ray_tracer.rays.Rays" title="giant.ray_tracer.rays.Rays"><code class="xref py py-class docutils literal notranslate"><span class="pre">Rays</span></code></a> objects where each element corresponds to the rays to 
use for the corresponding template in the <a class="reference internal" href="../../../../ray_tracer/scene/giant.ray_tracer.scene.Scene.html#giant.ray_tracer.scene.Scene.target_objs" title="giant.ray_tracer.scene.Scene.target_objs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Scene.target_objs</span></code></a> list.  Typically this should be left as 
<code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.grid_size">
<span class="sig-name descname"><span class="pre">grid_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.grid_size" title="Link to this definition">¶</a></dt>
<dd><p>The subsampling to use per pixel when rendering the template.  This should be the number of sub-pixels per side of 
a pixel (that is if grid_size=3 then subsampling will be in an equally spaced 3x3 grid -&gt; 9 sub-pixels per pixel).  
If <code class="docutils literal notranslate"><span class="pre">rays</span></code> is not None then this is ignored</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.template_overflow_bounds">
<span class="sig-name descname"><span class="pre">template_overflow_bounds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-1</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.template_overflow_bounds" title="Link to this definition">¶</a></dt>
<dd><p>The number of pixels to render in the template that overflow outside of the
camera field of view.  Set to a number less than 0 to accept all overflow
pixels in the template.  Set to a number greater than or equal to 0 to limit
the number of overflow pixels.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.peak_finder">
<span class="sig-name descname"><span class="pre">peak_finder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blur</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.peak_finder" title="Link to this definition">¶</a></dt>
<dd><p>This function returns a numpy array containing the (x, y) location of the maximum surface value
which corresponds to the peak of the fitted quadric surface to subpixel accuracy.</p>
<p>First, this function calls <code class="xref py py-func docutils literal notranslate"><span class="pre">pixel_level_peak_finder_2d()</span></code> to identify the pixel location of the peak of the
correlation surface.  It then fits a 2D quadric to the pixels around the peak and solves for the center of the
quadric to be the peak value.  The quadric equation that is fit is</p>
<div class="math notranslate nohighlight">
\[z = Ax^2+By^2+Cxy+Dx+Ey+F\]</div>
<p>where <span class="math notranslate nohighlight">\(z\)</span> is the height of the correlation surface at location <span class="math notranslate nohighlight">\((x,y)\)</span>, and <span class="math notranslate nohighlight">\(A--F\)</span> are the
coefficients to be fit.  The fit is performed in an algebraic least squares sense.
The location of the peak of the surface is then given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[\begin{array}{c}x_p \\ y_p\end{array}\right] = \frac{1}{4AB-C^2}\left[\begin{array}{c} CE-2BD\\
CD-2AE\end{array}\right]\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\((x_p,y_p)\)</span> is the location of the peak.</p>
<p>If the peak is invalid because it is too close to the edge, the fit failed, or the parabolic fit moved
the peak too far from the pixel level peak then the result is returned as NaNs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surface</strong> (<em>Buffer</em><em> | </em><em>_SupportsArray</em><em>[</em><em>dtype</em><em>[</em><em>Any</em><em>]</em><em>] </em><em>| </em><em>_NestedSequence</em><em>[</em><em>_SupportsArray</em><em>[</em><em>dtype</em><em>[</em><em>Any</em><em>]</em><em>]</em><em>] </em><em>| </em><em>complex</em><em> | </em><em>bytes</em><em> | </em><em>str</em><em> | </em><em>_NestedSequence</em><em>[</em><em>complex</em><em> | </em><em>bytes</em><em> | </em><em>str</em><em>]</em>) – A surface, or image, to use</p></li>
<li><p><strong>fit_size</strong> (<em>int</em>) – Number of pixels around the peak that are used in fitting the paraboloid</p></li>
<li><p><strong>blur</strong> (<em>bool</em>) – A flag to indicate whether to apply Gaussian blur to the correlation surface to filter out high
frequency noise</p></li>
<li><p><strong>shift_limit</strong> (<em>int</em>) – maximum difference from the pixel level peak to the fitted peak for the fitted peak to be
accepted</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The (x, y) location corresponding to the peak of fitted quadric surface to subpixel accuracy</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the provided surface is not 2 dimensional</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>ndarray</em>[tuple[<em>Any</em>, …], <em>dtype</em>[<em>float64</em>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.min_corr_score">
<span class="sig-name descname"><span class="pre">min_corr_score</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.3</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.min_corr_score" title="Link to this definition">¶</a></dt>
<dd><p>The minimum correlation score to accept for something to be considered found in an image. The correlation score 
is the Pearson Product Moment Coefficient between the image and the template. This should be a number between -1 
and 1, and in nearly every cast a number between 0 and 1.  Setting this to -1 essentially turns the minimum 
correlation score check off.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.blur">
<span class="sig-name descname"><span class="pre">blur</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.blur" title="Link to this definition">¶</a></dt>
<dd><p>A flag to perform a Gaussian blur on the correlation surface before locating the peak to remove high frequency noise</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.search_region">
<span class="sig-name descname"><span class="pre">search_region</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.search_region" title="Link to this definition">¶</a></dt>
<dd><p>The number of pixels to search around the a priori predicted center for the peak of the correlation surface.  If 
<code class="docutils literal notranslate"><span class="pre">None</span></code> then searches the entire correlation surface.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.run_pnp_solver">
<span class="sig-name descname"><span class="pre">run_pnp_solver</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.run_pnp_solver" title="Link to this definition">¶</a></dt>
<dd><p>A flag specifying whether to use the PnP solver to correct errors in the initial relative state between the camera 
and the target body</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.pnp_ransac_iterations">
<span class="sig-name descname"><span class="pre">pnp_ransac_iterations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.pnp_ransac_iterations" title="Link to this definition">¶</a></dt>
<dd><p>The number of RANSAC iterations to attempt in the PnP solver.  Set to 0 to turn the RANSAC component of the PnP 
solver</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.second_search_region">
<span class="sig-name descname"><span class="pre">second_search_region</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.second_search_region" title="Link to this definition">¶</a></dt>
<dd><p>The distance around the nominal location to search for each feature in the image after correcting errors using the 
PnP solver.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.measurement_sigma">
<span class="sig-name descname"><span class="pre">measurement_sigma</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">SCALAR_OR_ARRAY</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.measurement_sigma" title="Link to this definition">¶</a></dt>
<dd><p>The uncertainty to assume for each measurement in pixels. This is used to set the relative weight between the 
observed landmarks are the a priori knowledge in the PnP problem. See the <a class="reference internal" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.measurement_sigma" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.measurement_sigma"><code class="xref py py-attr docutils literal notranslate"><span class="pre">measurement_sigma</span></code></a> documentation 
for a description of valid inputs.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.position_sigma">
<span class="sig-name descname"><span class="pre">position_sigma</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">SCALAR_OR_ARRAY</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.position_sigma" title="Link to this definition">¶</a></dt>
<dd><p>The uncertainty to assume for the relative position vector in kilometers. This is used to set the relative weight 
between the observed landmarks and the a priori knowledge in the PnP problem. See the <a class="reference internal" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.position_sigma" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.position_sigma"><code class="xref py py-attr docutils literal notranslate"><span class="pre">position_sigma</span></code></a> 
documentation for a description of valid inputs.  If the <code class="docutils literal notranslate"><span class="pre">state_sigma</span></code> input is not <code class="docutils literal notranslate"><span class="pre">None</span></code> then this is 
ignored.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.attitude_sigma">
<span class="sig-name descname"><span class="pre">attitude_sigma</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">SCALAR_OR_ARRAY</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.attitude_sigma" title="Link to this definition">¶</a></dt>
<dd><p>The uncertainty to assume for the relative orientation rotation vector in radians. This is used to set the 
relative weight between the observed landmarks and the a priori knowledge in the PnP problem. See the 
<a class="reference internal" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.attitude_sigma" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.attitude_sigma"><code class="xref py py-attr docutils literal notranslate"><span class="pre">attitude_sigma</span></code></a> documentation for a description of valid inputs.  If the <code class="docutils literal notranslate"><span class="pre">state_sigma</span></code> input is not 
<code class="docutils literal notranslate"><span class="pre">None</span></code> then this is ignored.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.state_sigma">
<span class="sig-name descname"><span class="pre">state_sigma</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">NONEARRAY</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.state_sigma" title="Link to this definition">¶</a></dt>
<dd><p>The uncertainty to assume for the relative position vector and orientation rotation vector in kilometers and 
radians respectively. This is used to set the relative weight between the observed landmarks and the a priori 
knowledge in the PnP problem. See the <a class="reference internal" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.state_sigma" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.state_sigma"><code class="xref py py-attr docutils literal notranslate"><span class="pre">state_sigma</span></code></a> documentation for a description of valid inputs.  If 
this input is not <code class="docutils literal notranslate"><span class="pre">None</span></code> then the <code class="docutils literal notranslate"><span class="pre">attitude_sigma</span></code> and <code class="docutils literal notranslate"><span class="pre">position_sigma</span></code> inputs are ignored.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.max_lsq_iterations">
<span class="sig-name descname"><span class="pre">max_lsq_iterations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.max_lsq_iterations" title="Link to this definition">¶</a></dt>
<dd><p>The maximum number of iterations to make in the least squares solution to the PnP problem.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.lsq_relative_error_tolerance">
<span class="sig-name descname"><span class="pre">lsq_relative_error_tolerance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-08</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.lsq_relative_error_tolerance" title="Link to this definition">¶</a></dt>
<dd><p>The relative tolerance in the residuals to signal convergence in the least squares solution to the PnP problem.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.lsq_relative_update_tolerance">
<span class="sig-name descname"><span class="pre">lsq_relative_update_tolerance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-08</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.lsq_relative_update_tolerance" title="Link to this definition">¶</a></dt>
<dd><p>The relative tolerance in the update vector to signal convergence in the least squares solution to the PnP problem</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.cf_results">
<span class="sig-name descname"><span class="pre">cf_results</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">np.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.cf_results" title="Link to this definition">¶</a></dt>
<dd><p>A numpy array containing the center finding residuals for the target that the feature catalog is a part of.  If 
present this is used to correct errors in the a priori line of sight to the target before searching for features 
in the image.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.show_templates">
<span class="sig-name descname"><span class="pre">show_templates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.show_templates" title="Link to this definition">¶</a></dt>
<dd><p>A flag to show the rendered templates for each feature “live”. This is useful for debugging but in general should 
not be used.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.observable_type">
<span class="sig-name descname"><span class="pre">observable_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../estimator_interface_abc/giant.relative_opnav.estimators.estimator_interface_abc.RelNavObservablesType.html#giant.relative_opnav.estimators.estimator_interface_abc.RelNavObservablesType" title="giant.relative_opnav.estimators.estimator_interface_abc.RelNavObservablesType"><span class="pre">RelNavObservablesType</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../estimator_interface_abc/giant.relative_opnav.estimators.estimator_interface_abc.RelNavObservablesType.html#giant.relative_opnav.estimators.estimator_interface_abc.RelNavObservablesType" title="giant.relative_opnav.estimators.estimator_interface_abc.RelNavObservablesType"><span class="pre">RelNavObservablesType</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[RelNavObservablesType.LANDMARK]</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.observable_type" title="Link to this definition">¶</a></dt>
<dd><p>This technique generates LANDMARK bearing observables to the center of landmarks in the image.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.generates_templates">
<span class="sig-name descname"><span class="pre">generates_templates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.generates_templates" title="Link to this definition">¶</a></dt>
<dd><p>A flag specifying that this RelNav estimator generates and stores templates in the <a class="reference internal" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.templates" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.templates"><code class="xref py py-attr docutils literal notranslate"><span class="pre">templates</span></code></a> attribute.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.technique">
<span class="sig-name descname"><span class="pre">technique</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sfn'</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.technique" title="Link to this definition">¶</a></dt>
<dd><p>The name for the technique for registering with <a class="reference internal" href="../../../relnav_class/giant.relative_opnav.relnav_class.RelativeOpNav.html#giant.relative_opnav.relnav_class.RelativeOpNav" title="giant.relative_opnav.relnav_class.RelativeOpNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">RelativeOpNav</span></code></a>.</p>
<p>If None then the name will default to the name of the module where the class is defined.</p>
<p>This should typically be all lowercase and should not include any spaces or special characters except for <code class="docutils literal notranslate"><span class="pre">_</span></code> as 
it will be used to make attribute/method names.  (That is <code class="docutils literal notranslate"><span class="pre">MyEstimator.technique.isidentifier()</span></code> should evaluate 
<code class="docutils literal notranslate"><span class="pre">True</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.cf_index">
<span class="sig-name descname"><span class="pre">cf_index</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.cf_index" title="Link to this definition">¶</a></dt>
<dd><p>A list that maps the features catalogs contained in the <code class="docutils literal notranslate"><span class="pre">scene</span></code> (in order) to the appropriate column of the 
<code class="docutils literal notranslate"><span class="pre">cf_results</span></code> matrix.  If left blank the mapping is assumed to be in like order</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.visible_features">
<span class="sig-name descname"><span class="pre">visible_features</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.visible_features" title="Link to this definition">¶</a></dt>
<dd><p>This variable is used to notify which features are predicted to be visible in the image.</p>
<p>Each visible feature is identified by its index in the <code class="xref py py-attr docutils literal notranslate"><span class="pre">FeatureCatalog.features</span></code> list.</p>
</dd></dl>

</dd></dl>

<p class="rubric">Summary of Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.apply_options.html#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.apply_options" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.apply_options"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_options</span></code></a></p></td>
<td><p>Update the options as attributes of the object class</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.compute_rays.html#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.compute_rays" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.compute_rays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_rays</span></code></a></p></td>
<td><p>This method computes the required rays to render a given feature based on the current estimate of the location and orientation of the feature in the image.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.estimate.html#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.estimate" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.estimate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate</span></code></a></p></td>
<td><p>This method identifies the locations of surface features in the image through cross correlation of rendered templates with the image.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.pnp_solver.html#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.pnp_solver" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.pnp_solver"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pnp_solver</span></code></a></p></td>
<td><p>This method attempts to solve for an update to the relative position/orientation of the target with respect to the image based on the observed feature locations in the image.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.render.html#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.render" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.render"><code class="xref py py-obj docutils literal notranslate"><span class="pre">render</span></code></a></p></td>
<td><p>This method renders each visible feature for the current target according to the current estimate of the relative position/orientation between the target and the camera using single bounce ray tracing.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.reset.html#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.reset" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.reset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset</span></code></a></p></td>
<td><p>This method resets the observed/computed attributes as well as the details attribute to have <code class="docutils literal notranslate"><span class="pre">None</span></code> for each target in <code class="xref py py-attr docutils literal notranslate"><span class="pre">scene</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.target_generator.html#giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.target_generator" title="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.target_generator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">target_generator</span></code></a></p></td>
<td><p>This method returns a generator which yields target_index, target pairs that are to be processed based on the input <code class="docutils literal notranslate"><span class="pre">include_targets</span></code>.</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="../giant.relative_opnav.estimators.sfn.sfn_class.html" title="Previous document">sfn_class</a>
        </li>
        <li>
          <a href="giant.relative_opnav.estimators.sfn.sfn_class.SurfaceFeatureNavigation.apply_options.html" title="Next document">SurfaceFeatureNavigation.apply_options</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
<div class="footer">
    <div style="display:inline-block;vertical-align:middle;">
        <img src="/_static/NASA_logo.svg" alt="NASA" style="width:80px;height:80px;">
    </div>
    <div style="display:inline-block;vertical-align:middle;">
        &copy;2023 United States Government | 
        NASA Official: <a href="mailto:andrew.j.liounis@nasa.gov">Andrew Liounis</a> |
        Curator: <a href="mailto:andrew.j.liounis@nasa.gov">Andrew Liounis</a>
        <br>
        Last updated on Sep 03, 2025 |
        
        |
        Powered by <a href="http://sphinx-doc.org/">Sphinx 8.2.3</a>
        &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 1.0.0</a>
        
        |
        <a href="https://www.nasa.gov/about/highlights/HP_Privacy.html">Privacy Policy/Notices</a>
    </div>
</div>
  </body>
</html>