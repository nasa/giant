<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>limb_matching &#8212; GIANT 2.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=3f530b75" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=aae3c237" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <script src="../../_static/documentation_options.js?v=51b770b3"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="../../_static/logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="LimbMatchingOptions" href="limb_matching/giant.relative_opnav.estimators.limb_matching.LimbMatchingOptions.html" />
    <link rel="prev" title="EllipseMatching.target_generator" href="ellipse_matching/giant.relative_opnav.estimators.ellipse_matching.EllipseMatching.target_generator.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo.png" alt="Logo" />
    
  </a>
</p>



<p class="blurb">A powerful API for Optical Navigation</p>






<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installing GIANT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../giant.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../giant.html#indices">Indices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../copyright.html">Copyright</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../../giant.html">API Reference</a><ul>
  <li><a href="../../giant.relative_opnav.html">giant.relative_opnav</a><ul>
  <li><a href="../giant.relative_opnav.estimators.html">estimators</a><ul>
      <li>Previous: <a href="ellipse_matching/giant.relative_opnav.estimators.ellipse_matching.EllipseMatching.target_generator.html" title="previous chapter">EllipseMatching.target_generator</a></li>
      <li>Next: <a href="limb_matching/giant.relative_opnav.estimators.limb_matching.LimbMatchingOptions.html" title="next chapter">LimbMatchingOptions</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="ellipse_matching/giant.relative_opnav.estimators.ellipse_matching.EllipseMatching.target_generator.html" title="Previous document">EllipseMatching.target_generator</a>
        </li>
        <li>
          <a href="limb_matching/giant.relative_opnav.estimators.limb_matching.LimbMatchingOptions.html" title="Next document">LimbMatchingOptions</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="module-giant.relative_opnav.estimators.limb_matching">
<span id="limb-matching"></span><h1>limb_matching<a class="headerlink" href="#module-giant.relative_opnav.estimators.limb_matching" title="Link to this heading">¶</a></h1>
<p>This module provides the capability to locate the relative position of any target body by matching the observed limb in
an image with the shape model of the target.</p>
<section id="description-of-the-technique">
<h2>Description of the Technique<a class="headerlink" href="#description-of-the-technique" title="Link to this heading">¶</a></h2>
<p>Limb matching is a form of OpNav which produces a full 3DOF relative position measurement between the target and the
camera.  It is a sister technique of ellipse matching, but extended to general bodies.  It does this by matching
observed limb points in an image to surface points on the shape model and then solving the PnP problem (essentially
triangulation). As such, this can be a very powerful measurement because it is less sensitive to errors in the a priori
knowledge of your range to the target than cross correlation, provides more information than just the bearing to the
target for processing in a filter, and is more computationally efficient.  That being said, the line-of-sight/bearing
component of the estimate is generally slightly less accurate than cross correlation (when there is good a priori
knowledge of the shape and the range to the target). This is because limb matching only makes use of the visible
limb, while cross correlation makes use of all of the visible target.</p>
<p>Because matching the observed limb to a surface point is not a well defined problem for general bodies (not ellipsoidal)
this technique is iterative.  It keeps pairing the observed limbs with the correct surface points as the relative
position between the target and the camera is refined.  In addition, the limb pairing process needs the a priori
bearing of the target to be fairly close to the actual location of the target in the image.  Therefore, the algorithm
generally proceeds as follows:</p>
<ol class="arabic simple">
<li><p>If requested, identify the center of the target in the image using a moment algorithm (<a class="reference internal" href="giant.relative_opnav.estimators.moment_algorithm.html#module-giant.relative_opnav.estimators.moment_algorithm" title="giant.relative_opnav.estimators.moment_algorithm"><code class="xref py py-mod docutils literal notranslate"><span class="pre">moment_algorithm</span></code></a>) and
move the target’s a priori to be along the line of sight identified using the moment algorithm.</p></li>
<li><p>Identify the observed illuminate limb of the target in the image being processed using
<code class="xref py py-meth docutils literal notranslate"><span class="pre">ImageProcessing.identify_subpixel_limbs()</span></code> or <a class="reference internal" href="../../image_processing/limb_scanning/giant.image_processing.limb_scanning.LimbScanner.html#giant.image_processing.limb_scanning.LimbScanner" title="giant.image_processing.limb_scanning.LimbScanner"><code class="xref py py-class docutils literal notranslate"><span class="pre">LimbScanner</span></code></a></p></li>
<li><p>Pair the extracted limb points to possible surface points on the target shape using the current estimate of the state</p></li>
<li><p>Solve a linear least squares problem to update the state</p></li>
<li><p>Repeat steps 2-4 until convergence or maximum number of iterations exceeded</p></li>
</ol>
<p>Further details on the algorithm can be found <a class="reference external" href="https://bit.ly/3mQnB5J">here</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This implements limb based OpNav for irregular bodies.  For regular bodies, like planets and moons, see
<a class="reference internal" href="giant.relative_opnav.estimators.ellipse_matching.html#module-giant.relative_opnav.estimators.ellipse_matching" title="giant.relative_opnav.estimators.ellipse_matching"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ellipse_matching</span></code></a> which will be more efficient and accurate.</p>
</div>
<p>Typically this technique is used once the body is fully resolved in the image (around at least 50 pixels in apparent
diameter) and then can be used as long as the limb is visible in the image. For accurate results, this does require an
accurate shape model of the target, at least up to an unknown scale.  In addition, this technique can be sensitive to
errors in the knowledge of the relative orientation of the target frame to the image frame, therefore you need to have a
pretty good idea of its pole and spin state.  If you don’t have these things then this technique may still work but with
degraded results.  For very irregular bodies (bodies that are not mostly convex) this technique may be more dependent on
at least a decent a priori relative state between the camera and the target, as if the initial limb pairing is very far
off it may never recover.</p>
</section>
<section id="tuning">
<h2>Tuning<a class="headerlink" href="#tuning" title="Link to this heading">¶</a></h2>
<p>There are a few parameters to tune for this method.  The main thing that may make a difference is the choice and tuning
for the limb extraction routines.  There are 2 categories of routines you can choose from.  The first is edge
detection, where the limbs are extracted using only the image and the sun direction.  To tune the edge detection limb
extraction routines refer to the <a class="reference internal" href="../../image_processing/limb_edge_detection/giant.image_processing.limb_edge_detection.LimbEdgeDetection.html#giant.image_processing.limb_edge_detection.LimbEdgeDetection" title="giant.image_processing.limb_edge_detection.LimbEdgeDetection"><code class="xref py py-class docutils literal notranslate"><span class="pre">LimbEdgeDetection</span></code></a> class.</p>
<p>The other option for limb extraction is limb scanning.  In limb scanning, predicted illumination values based on the
shape model and a prior state are correlated with extracted scan lines to locate the limbs in the image.  This technique
can be quite accurate (if the shape model is accurate) but is typically much slower and the extraction must be repeated
each iteration.  The general tunings to use for limb scanning are from the <a class="reference internal" href="../../image_processing/limb_scanning/giant.image_processing.limb_scanning.LimbScanner.html#giant.image_processing.limb_scanning.LimbScanner" title="giant.image_processing.limb_scanning.LimbScanner"><code class="xref py py-class docutils literal notranslate"><span class="pre">LimbScanner</span></code></a> class:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">LimbScanner.number_of_scan_lines</span></code></p></td>
<td><p>The number of limb points to extract from the image</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">LimbScanner.scan_range</span></code></p></td>
<td><p>The extent of the limb to use centered on the sun line in radians (should
be &lt;= np.pi/2)</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">LimbScanner.number_of_sample_points</span></code></p></td>
<td><p>The number of samples to take along each scan line</p></td>
</tr>
</tbody>
</table>
<p>There are a few other things that can be tuned but they generally have limited effect.  See the <a class="reference internal" href="../../image_processing/limb_scanning/giant.image_processing.limb_scanning.LimbScanner.html#giant.image_processing.limb_scanning.LimbScanner" title="giant.image_processing.limb_scanning.LimbScanner"><code class="xref py py-class docutils literal notranslate"><span class="pre">LimbScanner</span></code></a>
class for more details.</p>
<p>In addition, there are a few knobs that can be tweaked on the class itself.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="limb_matching/giant.relative_opnav.estimators.limb_matching.LimbMatching.html#giant.relative_opnav.estimators.limb_matching.LimbMatching.extraction_method" title="giant.relative_opnav.estimators.limb_matching.LimbMatching.extraction_method"><code class="xref py py-attr docutils literal notranslate"><span class="pre">LimbMatching.extraction_method</span></code></a></p></td>
<td><p>Chooses the limb extraction method to be image processing or limb scanning.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">LimbMatching.max_iters</span></code></p></td>
<td><p>The maximum number of iterations to perform.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="limb_matching/giant.relative_opnav.estimators.limb_matching.LimbMatching.html#giant.relative_opnav.estimators.limb_matching.LimbMatching.recenter" title="giant.relative_opnav.estimators.limb_matching.LimbMatching.recenter"><code class="xref py py-attr docutils literal notranslate"><span class="pre">LimbMatching.recenter</span></code></a></p></td>
<td><p>A flag specifying whether to use a moment algorithm to set the initial guess
at the line of sight to the target or not.  If your a priori state knowledge
is bad enough that the predicted location of the target is outside of the
observed target in the image then you should set this to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">LimbMatching.discard_outliers</span></code></p></td>
<td><p>A flag specifying whether to remove outliers each iteration step.  Generally
this should be left to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></td>
</tr>
</tbody>
</table>
<p>Beyond this, you only need to ensure that you have a fairly accurate shape model of the target, the knowledge of the sun
direction in the image frame is good, and the knowledge of the rotation between the principal frame and the camera frame
is good.</p>
</section>
<section id="use">
<h2>Use<a class="headerlink" href="#use" title="Link to this heading">¶</a></h2>
<p>The class provided in this module is usually not used by the user directly, instead it is usually interfaced with
through the <a class="reference internal" href="../relnav_class/giant.relative_opnav.relnav_class.RelativeOpNav.html#giant.relative_opnav.relnav_class.RelativeOpNav" title="giant.relative_opnav.relnav_class.RelativeOpNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">RelativeOpNav</span></code></a> class using the identifier <a class="reference internal" href="../relnav_class/giant.relative_opnav.relnav_class.RelativeOpNav.html#giant.relative_opnav.relnav_class.RelativeOpNav.limb_matching" title="giant.relative_opnav.relnav_class.RelativeOpNav.limb_matching"><code class="xref py py-attr docutils literal notranslate"><span class="pre">limb_matching</span></code></a>.  For more
details on using the <a class="reference internal" href="../relnav_class/giant.relative_opnav.relnav_class.RelativeOpNav.html#giant.relative_opnav.relnav_class.RelativeOpNav" title="giant.relative_opnav.relnav_class.RelativeOpNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">RelativeOpNav</span></code></a> interface, please refer to the <a class="reference internal" href="../giant.relative_opnav.relnav_class.html#module-giant.relative_opnav.relnav_class" title="giant.relative_opnav.relnav_class"><code class="xref py py-mod docutils literal notranslate"><span class="pre">relnav_class</span></code></a> documentation.  For
more details on using the technique class directly, as well as a description of the <code class="docutils literal notranslate"><span class="pre">details</span></code> dictionaries produced
by this technique, refer to the following class documentation.</p>
</section>
<p class="rubric">Classes</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="limb_matching/giant.relative_opnav.estimators.limb_matching.LimbMatchingOptions.html#giant.relative_opnav.estimators.limb_matching.LimbMatchingOptions" title="giant.relative_opnav.estimators.limb_matching.LimbMatchingOptions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LimbMatchingOptions</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="limb_matching/giant.relative_opnav.estimators.limb_matching.LimbMatching.html#giant.relative_opnav.estimators.limb_matching.LimbMatching" title="giant.relative_opnav.estimators.limb_matching.LimbMatching"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LimbMatching</span></code></a></p></td>
<td><p>This class implements GIANT's version of limb based OpNav for irregular bodies.</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="ellipse_matching/giant.relative_opnav.estimators.ellipse_matching.EllipseMatching.target_generator.html" title="Previous document">EllipseMatching.target_generator</a>
        </li>
        <li>
          <a href="limb_matching/giant.relative_opnav.estimators.limb_matching.LimbMatchingOptions.html" title="Next document">LimbMatchingOptions</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
<div class="footer">
    <div style="display:inline-block;vertical-align:middle;">
        <img src="/_static/NASA_logo.svg" alt="NASA" style="width:80px;height:80px;">
    </div>
    <div style="display:inline-block;vertical-align:middle;">
        &copy;2023 United States Government | 
        NASA Official: <a href="mailto:andrew.j.liounis@nasa.gov">Andrew Liounis</a> |
        Curator: <a href="mailto:andrew.j.liounis@nasa.gov">Andrew Liounis</a>
        <br>
        Last updated on Sep 03, 2025 |
        
        |
        Powered by <a href="http://sphinx-doc.org/">Sphinx 8.2.3</a>
        &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 1.0.0</a>
        
        |
        <a href="https://www.nasa.gov/about/highlights/HP_Privacy.html">Privacy Policy/Notices</a>
    </div>
</div>
  </body>
</html>