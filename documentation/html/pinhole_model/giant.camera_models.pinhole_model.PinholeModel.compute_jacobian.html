<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>PinholeModel.compute_jacobian &#8212; GIANT 2.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=3f530b75" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=aae3c237" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <script src="../_static/documentation_options.js?v=51b770b3"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="icon" href="../_static/logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="PinholeModel.compute_pixel_jacobian" href="giant.camera_models.pinhole_model.PinholeModel.compute_pixel_jacobian.html" />
    <link rel="prev" title="PinholeModel.project_directions" href="giant.camera_models.pinhole_model.PinholeModel.project_directions.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" alt="Logo" />
    
  </a>
</p>



<p class="blurb">A powerful API for Optical Navigation</p>






<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installing GIANT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../giant.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../giant.html#indices">Indices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">Copyright</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../giant.html">API Reference</a><ul>
  <li><a href="../giant.camera_models.html">giant.camera_models</a><ul>
  <li><a href="../giant.camera_models.pinhole_model.html">giant.camera_models.pinhole_model</a><ul>
  <li><a href="giant.camera_models.pinhole_model.PinholeModel.html">PinholeModel</a><ul>
      <li>Previous: <a href="giant.camera_models.pinhole_model.PinholeModel.project_directions.html" title="previous chapter">PinholeModel.project_directions</a></li>
      <li>Next: <a href="giant.camera_models.pinhole_model.PinholeModel.compute_pixel_jacobian.html" title="next chapter">PinholeModel.compute_pixel_jacobian</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="giant.camera_models.pinhole_model.PinholeModel.project_directions.html" title="Previous document">PinholeModel.project_directions</a>
        </li>
        <li>
          <a href="giant.camera_models.pinhole_model.PinholeModel.compute_pixel_jacobian.html" title="Next document">PinholeModel.compute_pixel_jacobian</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="pinholemodel-compute-jacobian">
<h1>PinholeModel.compute_jacobian<a class="headerlink" href="#pinholemodel-compute-jacobian" title="Link to this heading">¶</a></h1>
<p><a class="reference internal" href="../giant.camera_models.pinhole_model.html#module-giant.camera_models.pinhole_model" title="giant.camera_models.pinhole_model"><code class="xref py py-mod docutils literal notranslate"><span class="pre">giant.camera_models.pinhole_model</span></code></a>:</p>
<dl class="py method">
<dt class="sig sig-object py" id="giant.camera_models.pinhole_model.PinholeModel.compute_jacobian">
<span class="sig-prename descclassname"><span class="pre">PinholeModel.</span></span><span class="sig-name descname"><span class="pre">compute_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit_vectors_in_camera_frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/giant/camera_models/pinhole_model.html#PinholeModel.compute_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#giant.camera_models.pinhole_model.PinholeModel.compute_jacobian" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the Jacobian matrix for each observation in <cite>unit_vectors_in_camera_frame</cite> for each parameter to be estimated
as defined in the <a class="reference internal" href="giant.camera_models.pinhole_model.PinholeModel.html#giant.camera_models.pinhole_model.PinholeModel.estimation_parameters" title="giant.camera_models.pinhole_model.PinholeModel.estimation_parameters"><code class="xref py py-attr docutils literal notranslate"><span class="pre">estimation_parameters</span></code></a> attribute.</p>
<p>This method works by first computing the partial derivatives for all camera parameters for each provided unit
vector. It then concatenates the rows into the Jacobian matrix and removes any columns of parameters that
are not specified in the <a class="reference internal" href="giant.camera_models.pinhole_model.PinholeModel.html#giant.camera_models.pinhole_model.PinholeModel.estimation_parameters" title="giant.camera_models.pinhole_model.PinholeModel.estimation_parameters"><code class="xref py py-attr docutils literal notranslate"><span class="pre">estimation_parameters</span></code></a> attribute and sorts the columns according to the order
of the <a class="reference internal" href="giant.camera_models.pinhole_model.PinholeModel.html#giant.camera_models.pinhole_model.PinholeModel.estimation_parameters" title="giant.camera_models.pinhole_model.PinholeModel.estimation_parameters"><code class="xref py py-attr docutils literal notranslate"><span class="pre">estimation_parameters</span></code></a> attribute. The resulting Jacobian
will be the appropriate size and in the order specified by <a class="reference internal" href="giant.camera_models.pinhole_model.PinholeModel.html#giant.camera_models.pinhole_model.PinholeModel.estimation_parameters" title="giant.camera_models.pinhole_model.PinholeModel.estimation_parameters"><code class="xref py py-attr docutils literal notranslate"><span class="pre">estimation_parameters</span></code></a>.  There is one
constraint that the misalignment (if included) must be last in <a class="reference internal" href="giant.camera_models.pinhole_model.PinholeModel.html#giant.camera_models.pinhole_model.PinholeModel.estimation_parameters" title="giant.camera_models.pinhole_model.PinholeModel.estimation_parameters"><code class="xref py py-attr docutils literal notranslate"><span class="pre">estimation_parameters</span></code></a>.</p>
<p>The <cite>unit_vectors_in_camera_frame</cite> inputs should be formatted as a Sequence of 2d sequences.  Each inner 2D sequence
should be of shape <span class="math notranslate nohighlight">\(3\times x\)</span>, where each row corresponds to a component of a unit vector in the camera
frame. Each inner sequence should contain all observations from a single image, so that if there are <span class="math notranslate nohighlight">\(m\)</span>
images being considered, then the outer sequence should be length <span class="math notranslate nohighlight">\(m\)</span>.  The value of <span class="math notranslate nohighlight">\(x\)</span> can change
for each image. If you are estimating multiple misalignments (one for each image) then each misalignment will
correspond to the order of the image observations in the outer sequence.</p>
<p>You can also set the <a class="reference internal" href="giant.camera_models.pinhole_model.PinholeModel.html#giant.camera_models.pinhole_model.PinholeModel.use_a_priori" title="giant.camera_models.pinhole_model.PinholeModel.use_a_priori"><code class="xref py py-attr docutils literal notranslate"><span class="pre">use_a_priori</span></code></a> to True to have this method append an identity matrix to the bottom of
this Jacobian if you are solving for an update to your camera model, and not a new one entirely.</p>
<p>The optional <cite>temperature</cite> input specifies the temperature of the camera for use in estimating temperature
dependence.  The temperature input should either be a scalar value (float or int), or a list that is the same
length as <cite>unit_vectors_in_camera_frame</cite>, where each element of the list is the temperature of the camera at the time
of each image represented by <cite>unit_vectors_in_camera_frame</cite>.  If the <cite>temperature</cite> input is a scalar, then it is assumed
to be the temperature value for all of the images represented in <cite>unit_vectors_in_camera_frame</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unit_vectors_in_camera_frame</strong> (<em>Sequence</em><em>[</em><em>ndarray</em><em>[</em><em>tuple</em><em>[</em><em>Any</em><em>, </em><em>...</em><em>]</em><em>, </em><em>dtype</em><em>[</em><em>float64</em><em>]</em><em>] </em><em>| </em><em>list</em><em>[</em><em>list</em><em>]</em><em>]</em>) – The points/directions in the camera frame that the jacobian matrix is to be computed
for.  For multiple images, this should be a list of 2D unit vectors where each
element of the list corresponds to a new image.</p></li>
<li><p><strong>temperature</strong> (<em>float</em><em> | </em><em>ndarray</em><em>[</em><em>tuple</em><em>[</em><em>Any</em><em>, </em><em>...</em><em>]</em><em>, </em><em>dtype</em><em>[</em><em>float64</em><em>]</em><em>] </em><em>| </em><em>Sequence</em><em>[</em><em>float</em><em>]</em>) – A single temperature for all images or a list of temperatures the same length of
<cite>unit_vectors_in_camera_frame</cite> containing the temperature of the camera at the time each image was
captured</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The Jacobian matrix evaluated for each observation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">giant.camera_models</span><span class="w"> </span><span class="kn">import</span> <span class="n">PinholeModel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">PinholeModel</span><span class="p">(</span><span class="n">kx</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">ky</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">px</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">py</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">focal_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">a1</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">a2</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="n">misalignment</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">1e-12</span><span class="p">,</span> <span class="o">-</span><span class="mf">2e-14</span><span class="p">,</span> <span class="mf">3e-10</span><span class="p">],</span> <span class="p">[</span><span class="mf">2e-15</span><span class="p">,</span> <span class="mf">1e-13</span><span class="p">,</span> <span class="mf">3e-10</span><span class="p">]],</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="n">estimation_parameters</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;multiple misalignments&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">compute_jacobian</span><span class="p">([[[</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="n">temperature</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">])</span>
<span class="go">array([[  0.00000000e+00,  -3.75075000e+03,   0.00000000e+00,</span>
<span class="go">          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],</span>
<span class="go">       [  4.00080000e+03,   2.98059600e-07,  -2.00040000e+03,</span>
<span class="go">          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],</span>
<span class="go">       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,</span>
<span class="go">         -5.62612499e+00,  -3.00247537e+03,  -2.25045000e+02],</span>
<span class="go">       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,</span>
<span class="go">          4.02330450e+03,   7.50150000e+00,  -1.00020000e+02],</span>
<span class="go">       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,</span>
<span class="go">         -9.60191999e+00,  -3.00540096e+03,  -2.40048000e+02],</span>
<span class="go">       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,</span>
<span class="go">          4.02640512e+03,   1.28025600e+01,  -1.60032000e+02],</span>
<span class="go">       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,</span>
<span class="go">         -1.25025000e+01,  -3.00810150e+03,  -2.50050000e+02],</span>
<span class="go">       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,</span>
<span class="go">          4.02858333e+03,   1.66700000e+01,  -2.00040000e+02]])</span>
</pre></div>
</div>
<p>Mathematically the Jacobian matrix is defined to be</p>
<div class="math notranslate nohighlight">
\[\frac{\partial\mathbf{x}_P}{\partial\mathbf{c}} = \left[\begin{array}{cccc}
\frac{\partial\mathbf{x}_P}{\partial f} &amp; \frac{\partial\mathbf{x}_P}{\mathbf{k}} &amp;
\frac{\partial\mathbf{x}_P}{\partial\mathbf{a}} &amp;
\frac{\partial\mathbf{x}_P}{\partial\boldsymbol{\delta\theta}}\end{array}\right]\]</div>
<p>where, using the chain rule,</p>
<div class="math notranslate nohighlight">
\begin{gather}
\frac{\partial\mathbf{x}_P}{\partial f} =
\frac{\partial\mathbf{x}_P}{\partial\mathbf{x}_I}
\frac{\partial\mathbf{x}_I}{\partial f} \\
\frac{\partial\mathbf{x}_P}{\partial\boldsymbol{\delta\theta}} =
\frac{\partial\mathbf{x}_P}{\partial\mathbf{x}_I}
\frac{\partial\mathbf{x}_I}{\partial\mathbf{x}_C'}
\frac{\partial\mathbf{x}_C'}{\partial\boldsymbol{\delta\theta}}
\end{gather}</div><p>and</p>
<div class="math notranslate nohighlight">
\begin{gather}
\frac{\partial\mathbf{x}_P}{\partial\mathbf{k}} = \left[\begin{array}{cccc} x_I &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; y_I &amp; 0 &amp; 1 \end{array}\right] \\
\frac{\partial\mathbf{x}_P}{\partial\mathbf{a}} = \left[\begin{array}{cc} k_x &amp; 0 \\
0 &amp; k_y\end{array}\right] \mathbf{x}_I \left[\begin{array}{ccc} T &amp; T^2 &amp; T^3 \end{array}\right] \\
\frac{\partial\mathbf{x}_P}{\partial\mathbf{x}_I} = (1+a_1T+a_2T^2+a_3T^3)
\left[\begin{array}{cc} k_x &amp; 0 \\ 0 &amp; k_y \end{array}\right] \\
\frac{\partial\mathbf{x}_I}{\partial f} = \frac{1}{z_C'}
\left[\begin{array}{c}x_C'\\y_C'\end{array}\right] \\
\frac{\partial\mathbf{x}_P}{\partial\mathbf{x}_I} = (1+a_1T+a_2T^2+a_3T^3)
\left[\begin{array}{cc} k_x &amp; 0 \\ 0 &amp; k_y \end{array}\right] \\
\frac{\partial\mathbf{x}_I}{\partial\mathbf{x}_C'} = \frac{f}{z_C'}\left[
\begin{array}{ccc}1 &amp; 0 &amp; \frac{-x_C'}{z_C'} \\ 0 &amp; 1 &amp; \frac{-y_C'}{z_C'} \end{array}\right] \\
\frac{\partial\mathbf{x}_C'}{\partial\boldsymbol{\delta\theta}} = \left[\mathbf{x}_C\times\right]
\end{gather}</div><p>where <span class="math notranslate nohighlight">\(\mathbf{k}=[k_x \quad k_y \quad p_x \quad p_y]\)</span> is a vector of the intrinsic camera parameters,
<span class="math notranslate nohighlight">\(\mathbf{a}=[a_1 \quad a_2 \quad a_3]\)</span> is a vector of the temperature dependence coefficients,
<span class="math notranslate nohighlight">\(\mathbf{x}_C'\)</span> is the camera frame point after applying the misalignment,
<span class="math notranslate nohighlight">\(\boldsymbol{\delta\theta}\)</span> is the misalignment vector, <span class="math notranslate nohighlight">\(\mathbf{x}_C\)</span> is the camera frame point
before misalignment is applied, <span class="math notranslate nohighlight">\(\left[\bullet\times\right]\)</span> is the skew-symmetric cross product
matrix formed from <span class="math notranslate nohighlight">\(\bullet\)</span>,
<span class="math notranslate nohighlight">\(\mathbf{x}_P\)</span> is the pixel location, <span class="math notranslate nohighlight">\(\mathbf{x}_I\)</span> is the gnomic location,
<span class="math notranslate nohighlight">\(a_{1-3}\)</span> are the temperature coefficients, <span class="math notranslate nohighlight">\(T\)</span> is the temperature, <span class="math notranslate nohighlight">\(k_x\)</span> is the inverse of
the pixel pitch in the x direction, and <span class="math notranslate nohighlight">\(k_y\)</span> is the inverse of the pixel pitch in the y direction.</p>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="giant.camera_models.pinhole_model.PinholeModel.project_directions.html" title="Previous document">PinholeModel.project_directions</a>
        </li>
        <li>
          <a href="giant.camera_models.pinhole_model.PinholeModel.compute_pixel_jacobian.html" title="Next document">PinholeModel.compute_pixel_jacobian</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
<div class="footer">
    <div style="display:inline-block;vertical-align:middle;">
        <img src="/_static/NASA_logo.svg" alt="NASA" style="width:80px;height:80px;">
    </div>
    <div style="display:inline-block;vertical-align:middle;">
        &copy;2023 United States Government | 
        NASA Official: <a href="mailto:andrew.j.liounis@nasa.gov">Andrew Liounis</a> |
        Curator: <a href="mailto:andrew.j.liounis@nasa.gov">Andrew Liounis</a>
        <br>
        Last updated on Sep 03, 2025 |
        
        |
        Powered by <a href="http://sphinx-doc.org/">Sphinx 8.2.3</a>
        &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 1.0.0</a>
        
        |
        <a href="https://www.nasa.gov/about/highlights/HP_Privacy.html">Privacy Policy/Notices</a>
    </div>
</div>
  </body>
</html>